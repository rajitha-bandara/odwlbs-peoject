/*1337135642,176820665*/

if (window.CavalryLogger) { CavalryLogger.start_js(["Pli4i"]); }

__d("DragDropFileUpload",[],function(a,b,c,d,e,f){f.isSupported=function(){return typeof(FileList)!=="undefined";};});
__d("ArbiterDragDrop",["Arbiter","DragDropFileUpload"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('DragDropFileUpload'),i='dnd/drag/in',j='dnd/drag/out',k='dnd/drag/drop',l=false,m=function(){if(l)return;l=true;if(!h.isSupported())return;if(!document.addEventListener)return;var o=0;document.addEventListener('dragenter',function(r){if(o===0)g.inform(i,r,g.BEHAVIOR_EVENT);o++;},false);document.addEventListener('dragleave',function(r){o--;if(o===0)g.inform(j,r,g.BEHAVIOR_EVENT);},false);document.addEventListener('drop',function(r){g.inform(k,r,g.BEHAVIOR_EVENT);r.preventDefault();},false);document.addEventListener('dragover',function(r){r.preventDefault();},false);var p=null,q=function(){o=0;g.inform(j,null,g.BEHAVIOR_EVENT);};document.addEventListener('dragover',function(r){p&&window.clearTimeout(p);p=window.setTimeout(q,839);},true);},n=function(o){m();return o;};e.exports={dragEnter:n.bind(null,i),dragLeave:n.bind(null,j),dragDrop:n.bind(null,k)};});
__d("css_on_global_drag",["ArbiterDragDrop","Arbiter","CSS"],function(a,b,c,d,e,f){var g=b('ArbiterDragDrop'),h=b('Arbiter'),i=b('CSS');e.exports=function(j,k){var l=h.subscribe(g.dragEnter(),i.addClass.bind(i,j,k),h.SUBSCRIBE_NEW),m=h.subscribe(g.dragLeave(),i.removeClass.bind(i,j,k),h.SUBSCRIBE_NEW);return function(){l.unsubscribe();m.unsubscribe();};};});
__d("DragDropTarget",["CSS","DragDropFileUpload","copyProperties","css_on_global_drag"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DragDropFileUpload'),i=b('copyProperties'),j=b('css_on_global_drag');function k(l,m){this.element=l;this.preprocess=function(n){return n;};this.onDrop=m;}i(k.prototype,{setPreprocessor:function(l){this.preprocess=l;return this;},activate:function(){if(!h.isSupported())return;if(!document.addEventListener)return;var l=j(this.element,'fbWantsDragDrop'),m=0;this.element.addEventListener('dragenter',(function(){if(m===0)g.addClass(this.element,'fbDropReady');m++;}).bind(this),false);var n=g.removeClass.bind(g,this.element,'fbDropReady');this.element.addEventListener('dragleave',(function(){m=Math.max(m-1,0);if(m===0)n();}).bind(this),false);this.element.addEventListener('dragover',function(o){o.preventDefault();o.stopPropagation();},false);this.element.addEventListener('drop',(function(o){o.preventDefault();o.stopPropagation();var p=this.preprocess(o.dataTransfer.files);m=0;n();if(p.length)this.onDrop(p);}).bind(this),false);}});e.exports=k;});
__d("FileUpload",["Arbiter","CSS","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('copyProperties'),j=function(k){this.file=k;this.failureCode=null;this.failureSummary=null;this.failureDescription=null;this.serverPayload=null;};i(j.prototype,{getFile:function(){return this.file;},isComplete:function(){return !!this.serverPayload;},complete:function(k){this.serverPayload=k;return this;},isSuccess:function(){return this.isComplete()&&!this.failureCode;},getResponsePayload:function(){return this.serverPayload;},fail:function(k,l,m){this.failureCode=k;this.failureSummary=l;this.failureDescription=m;return this;},getFailureCode:function(){return this.failureCode;},getFailureSummary:function(){return this.failureSummary;},getFailureDescription:function(){return this.failureDescription;}});e.exports=j;});
__d("AJAXFileUploader",["AsyncRequest","FileUpload","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('FileUpload'),i=b('copyProperties');function j(k,l,m){this.files=k;this.uploadURI=l;this.uploads=[];this.finishedCount=0;this.succeeded=[];this.failed=[];this.onComplete=m;this.relativeElem=null;for(var n=0;n<k.length;n++)this.uploads.push(new h(k[n]));}i(j.prototype,{startUpload:function(){for(var k=0;k<this.uploads.length;k++)new g().setURI(this.uploadURI).setRawData(this.files[k]).setRelativeTo(this.relativeElem).setStatusElement(this.relativeElem).setHandler(this.handler.bind(this,k)).setErrorHandler(this.errorHandler.bind(this,k)).send();},setRelativeTo:function(k){this.relativeElem=k;return this;},handler:function(k,l){this.uploads[k].complete(l.getPayload());this.succeeded.push(this.uploads[k]);this.onResponse();},errorHandler:function(k,l){this.uploads[k].fail(l.getError(),l.getErrorSummary(),l.getErrorDescription());if(l.getPayload())this.uploads[k].complete(l.getPayload());this.failed.push(this.uploads[k]);this.onResponse();},onResponse:function(){this.finishedCount++;if(this.finishedCount===this.uploads.length)this.onComplete(this.succeeded,this.failed);}});e.exports=j;});
__d("FileUploadTarget",["AJAXFileUploader","DragDropFileUpload","DragDropTarget","copyProperties"],function(a,b,c,d,e,f){var g=b('AJAXFileUploader'),h=b('DragDropFileUpload'),i=b('DragDropTarget'),j=b('copyProperties');function k(l,m){var n=(function(o){new g(o,m,this.onCompleteCallback).setRelativeTo(l).startUpload();}).bind(this);this.dragDropTarget=new i(l,(function(o){o.length&&this.asyncProcess(o,function(p){p.length&&n(p);});}).bind(this));this.asyncProcess=function(o,p){p(o);};this.preprocess=function(o){return o;};this.onCompleteCallback=bagofholding;}j(k.prototype,{setPreprocessor:function(l){this.preprocess=l;return this;},setAsyncProcessor:function(l){this.asyncProcess=l;return this;},onComplete:function(l){this.onCompleteCallback=l;return this;},activate:function(){if(!h.isSupported())return;this.dragDropTarget.setPreprocessor(this.preprocess).activate();}});e.exports=k;});
__d("SinglePictureUploadTarget",["Bootloader","Dialog","ErrorDialog","FileUploadTarget","StringEscape","tx","copyProperties"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('Dialog'),i=b('ErrorDialog'),j=b('FileUploadTarget'),k=b('StringEscape'),l=b('tx'),m=b('copyProperties');function n(o,p){this.fileUploadTarget=new j(o,p);this.preprocessCallback=bagofholding;this.oncompleteCallback=bagofholding;this.afterSuccessCallback=bagofholding;this.maxWidth=null;this.maxHeight=null;}m(n.prototype,{setPreprocessCallback:function(o){this.preprocessCallback=o;return this;},setOncompleteCallback:function(o){this.oncompleteCallback=o;return this;},setAfterSuccessCallback:function(o){this.afterSuccessCallback=o;return this;},setMaximumDimensions:function(o,p){this.maxWidth=o;this.maxHeight=p;return this;},activate:function(){var o=function(s){return k.htmlSpecialChars(s.name);},p=(function(s){if(s.length>1){i.show("Upload Error",l._("You can only select {max-photos} photos to upload to this album.  Only the first {max-photos} photo you selected will be uploaded.",{'max-photos':1}));s=[s[0]];}var t=s[0];if(!t.type.match(/^image\//)){i.show("Upload Error",l._("We could not understand the contents of {filename}.  Make sure it is a jpg, gif, or png formatted image.",{filename:o(t)}));return [];}this.preprocessCallback(s);return s;}).bind(this),q=(function(s,t){var u=1024*1024*16,v=1024*1024*1,w=function(y){if(y.size>u){i.show("Upload Error",l._("{filename} is too large. Please resize your photo to under\n                     8000x8000 pixels and try again.",{filename:o(s[0])}));t([]);}else t([y]);},x=s[0];if((x.size<v)||(!this.maxWidth&&!this.maxHeight)){w(x);}else g.loadModules(['ImageExif','ImageResizer'],function(y,z){if(!z.isSupported()){w(x);return;}var aa=new z(x,this.maxWidth,this.maxHeight);aa.subscribe('resized',function(ba,ca){if(ca.size>x.size){w(x);}else w(ca);}.bind(this));aa.subscribe('error',function(){w(x);}.bind(this));y.readFromFile(x,function(ba){ba&&aa.setOrientation(ba.Orientation);aa.resize();});});}).bind(this),r=(function(s,t){this.oncompleteCallback(s,t);if(s.length){var u=s[0].getResponsePayload();this.afterSuccessCallback(u);}else{var v=t[0];if(v.serverPayload&&v.serverPayload.__dialog){var w=new h();w._setFromModel(v.serverPayload.__dialog);w.setButtons(h.OK).show();}else i.show(v.failureSummary,v.failureDescription);}}).bind(this);return this.fileUploadTarget.onComplete(r).setPreprocessor(p).setAsyncProcessor(q).activate();}});e.exports=n;});
__d("TimelineProfilePic",["Arbiter","CSS","Dialog","DOM","HTML","Run","$","ge","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('Dialog'),j=b('DOM'),k=b('HTML'),l=b('Run'),m=b('$'),n=b('ge'),o=b('copyProperties');function p(q,r,s,t){p.destroyInstance();p._instance=this;this.leavingMessage=r;this.elemID=s||'fbProfileCover';this.elemClass=t||'.profilePicThumb';this._arbiterTokens=[g.subscribe(q.LOADING,this.startLoading.bind(this)),g.subscribe(q.SUCCESS,this.onUploadSuccess.bind(this))];l.onBeforeUnload(this.onBeforeUnload.bind(this));l.onLeave(this.destroy.bind(this));}o(p,{_instance:null,destroyInstance:function(){this._instance&&this._instance.destroy();}});o(p.prototype,{_setLoadingIndicator:function(q){this._loading=q;h.conditionClass(j.find(m(this.elemID),this.elemClass),'profilePicLoading',q);},destroy:function(){this._arbiterTokens.forEach(function(q){q.unsubscribe();});this._arbiterTokens=[];p._instance=null;},startLoading:function(q,r){this._setLoadingIndicator(r.isLoading);if(n('fbProfilePicSelector'))h.removeClass(m('fbProfilePicSelector'),'fbTimelineNullProfilePicSelector');},onUploadSuccess:function(q,r){this._setLoadingIndicator(false);var s=i.getCurrent();if(s)s.hide();j.replace(j.find(m(this.elemID),this.elemClass),k(r.newPic));},onBeforeUnload:function(){if(p._instance===this&&this._loading)return this.leavingMessage;}});e.exports=p;});
var TimelineStar={STAR_CSS_ONLY:1,STAR_ASYNC_REQUIRED:2,ACTION_STAR:7,ACTION_UNSTAR:8,starClicked:false,starUnit:function(a,b,c){var d=a.parentNode;if(!c)DOM.setContent(d,b);CSS.removeClass(d,'fbTimelineTwoColumn');CSS.addClass(d,'fbTimelineOneColumn');d.removeAttribute('data-side');d.setAttribute('data-size','2');Tooltip.hide();TimelineCapsule.balanceCapsule.curry(d.parentNode).defer();},unstarUnit:function(a,b,c){var d=a.parentNode;if(!c)DOM.setContent(d,b);CSS.removeClass(d,'fbTimelineOneColumn');CSS.addClass(d,'fbTimelineTwoColumn');d.setAttribute('data-side','l');d.setAttribute('data-size','1');Tooltip.hide();TimelineCapsule.balanceCapsule.curry(d.parentNode).defer();},listenToButton:function(a,b){var c=ge(a);if(!c)return;switch(b){case TimelineStar.STAR_CSS_ONLY:Event.listen(c,'click',function(event){Button.setEnabled(c,false);var e=Parent.byClass(c,'timelineUnitContainer'),f=TimelineStar.unstarUnit;CSS.toggleClass(c,'fbTimelineStarButtonSelected');CSS.toggleClass(c,'selected');if(e.parentNode.getAttribute('data-size')=='1')f=TimelineStar.starUnit;f(Parent.byClass(c,'timelineUnitContainer'),null,true);var g=new URI(c.getAttribute('ajaxify')),h=g.getQueryData().customize_action==TimelineStar.ACTION_STAR?TimelineStar.ACTION_UNSTAR:TimelineStar.ACTION_STAR;g.addQueryData({customize_action:h});c.setAttribute.bind(c,'ajaxify',g).defer();});var d=Parent.byClass(c,'stat_elem');d&&CSS.removeClass(d,'stat_elem');break;case TimelineStar.STAR_ASYNC_REQUIRED:break;}}};
__d("timeline-cover-dragdrop-edit",["SinglePictureUploadTarget","TimelineCover"],function(a,b,c,d,e,f){var g=b('SinglePictureUploadTarget'),h=b('TimelineCover'),i=function(m,n){var o=h.getInstance();o.hideLoadingIndicator();},j=function(m){var n=h.getInstance(),o=m.id,p=m.photo_html;n.updateCoverImage(o,p);},k=function(m){h.getInstance().showLoadingIndicator();},l=function(m,n,o,p){new g(m,n).setMaximumDimensions(o,p).setPreprocessCallback(k).setOncompleteCallback(i).setAfterSuccessCallback(j).activate();};f.initialize_timeline_cover_drop_target=l;});
__d("TimelineAudienceSelector",["Arbiter","CSS","DOM","Parent","PrivacyConst","Selector"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('Parent'),k=b('PrivacyConst'),l=b('Selector');function m(){var p='timelineOnlyMeBorder';return [i.create('div',{className:p}),i.create('div',{className:p+' timelineOnlyMeBorderBottom'})];}function n(){return i.create('img',{alt:' ',className:'timelinePrivacyCorner',height:34,src:'/images/profile/timeline/privacy_corner.png',width:34});}function o(p){var q=i.scry(p,'.photoUnit a.photo');return q.filter(function(r){return !i.scry(r,'.timelinePrivacyCorner').length;});}g.subscribe('AudienceSelector/changed',function(p,q){var r=l.getOptionValue(q.option),s=j.byClass(q.selector,'timelineUnitContainer')||j.byClass(q.clone,'fbTimelineTwoColumn');if(!s)return;if(r==k.BaseValue.SELF){h.addClass(s,'timelineOnlyMeUnit');var t=o(s);for(var u=0,v=t.length;u<v;++u)i.appendContent(t[u],n());if(!i.scry(s,'div.timelineOnlyMeBorder').length){var w=m();i.prependContent(s,w[0]);i.appendContent(s,w[1]);}}else h.removeClass(s,'timelineOnlyMeUnit');});});
__d("profile-pic-dragdrop-edit",["Arbiter","SinglePictureUploadTarget","TimelineProfilePic"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('SinglePictureUploadTarget'),i=b('TimelineProfilePic');f.initialize_profile_pic_drop_target=function(j,k,l,m){new i(l,m);new h(j,k).setPreprocessCallback(function(n){g.inform(l.LOADING,{isLoading:1},g.BEHAVIOR_STATE);}).setOncompleteCallback(function(n,o){g.inform(l.LOADING,{isLoading:0},g.BEHAVIOR_STATE);}).setAfterSuccessCallback(function(n){g.inform(l.SUCCESS,{newPic:n.photo_html},g.BEHAVIOR_STATE);}).activate();};});
function FutureProfileSideNav(){this.parent.construct(this);}Class.extend(FutureProfileSideNav,'FutureSideNav');copy_properties(FutureProfileSideNav.prototype,{init:function(){this.parent.init.apply(this,arguments);this.ajaxPipe=true;this.altKeyParam='v';this.sidecol=false;},_constructItem:function(a,b){return new FutureProfileSideNavItem(a,b);},_doPageTransition:function(a,b){if(!this._profileChanged(b)&&!this._scopeChanged(a))return this.parent._doPageTransition(a,b);},_profileChanged:function(a){var b=a.getQueryData(),c=this.uri.getQueryData();return (b.id!==c.id||b.viewas!==c.viewas||b.and!==c.and);},_scopeChanged:function(a){return (!this.selected||a.layoutType!==this.selected.layoutType);},_getKey:function(a){return this.parent._getKey(a)||a[this.altKeyParam];}});function FutureProfileSideNavItem(a,b){this.parent.construct(this,a,b);this.layoutType=a.layouttype;}Class.extend(FutureProfileSideNavItem,'FutureSideNavItem');
__d("SubscriptionLevels",[],function(a,b,c,d,e,f){var g={ALL:'162318810514679',DEFAULT:'271670892858696',TOP:'266156873403755'};e.exports=g;});
__d("EditSubscriptions",["event-extensions","function-extensions","Arbiter","AsyncRequest","CSS","DOM","ge","Menu","Parent","SubscriptionLevels"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOM'),k=b('ge'),l=b('Menu'),m=b('Parent'),n=b('SubscriptionLevels'),o=13,p=45,q=[n.ALL,n.DEFAULT,n.TOP],r={},s={},t={},u={},v={},w={},x={},y={},z={},aa={},ba="/ajax/follow/follow_profile.php",ca="/ajax/follow/unfollow_profile.php";function da(va){return q.contains(va);}function ea(va,wa,xa,ya){var za=m.byClass(ya,'uiMenuItem')||m.byClass(ya,'uiMenuXItem');if(!za||!j.contains(va,za)){return;}else if(i.hasClass(za,'SubscribeMenuSubscribeCheckbox')){if(t[wa]){ha(va,wa);}else ga(va,wa);return false;}else if(i.hasClass(za,'SubscribeMenuUnsubscribe')){ha(va,wa);return false;}else if(i.hasClass(za,'SubscribeMenuSettingsItem')){ta(va,true);return false;}else if(i.hasClass(za,'SubscriptionMenuGoBack')){ta(va,false);return false;}else if(i.hasClass(za,'SubscriptionMenuItem')){fa(va,wa,xa,za);return false;}}function fa(va,wa,xa,ya){if(i.hasClass(ya,'SubscriptionMenuLevel')){if(l.isItemChecked(ya))return;ra(va,wa,la(ya),true,xa);}else if(i.hasClass(ya,'SubscriptionMenuCategory'))pa(wa,ya,!l.isItemChecked(ya),true,xa);}function ga(va,wa){var xa={profile_id:wa};g.inform('FollowingUser',xa);new h().setURI(ba).setMethod('POST').setData({profile_id:wa,location:ia(va)}).setErrorHandler(g.inform.curry('FollowUserFail',xa)).send();}function ha(va,wa){var xa={profile_id:wa};g.inform('UnfollowingUser',xa);new h().setURI(ca).setMethod('POST').setData({profile_id:wa,location:ia(va)}).setErrorHandler(g.inform.curry('UnfollowUserFail',xa)).send();}function ia(va){if(i.hasClass(va,'followButtonFlyout')){return o;}else return p;}function ja(va,wa,xa){var ya={profile_id:va,level:x[va],custom_categories:y[va],location:xa};new h().setURI('/ajax/follow/manage_subscriptions.php').setData(ya).send();}function ka(va,wa){var xa=y[wa]||[],ya=l.getItems(va);ya.forEach(function(za){if(i.hasClass(za,'SubscriptionMenuCategory')){var ab=la(za);if(xa.contains(ab)){na(za);}else oa(za);}});ra(va,wa,x[wa],false);}function la(va){var wa=j.scry(va,'input')[0];return wa&&wa.value;}function ma(va){return j.find(va,'a.itemAnchor');}function na(va){i.addClass(va,'checked');ma(va).setAttribute('aria-checked',true);}function oa(va){i.removeClass(va,'checked');ma(va).setAttribute('aria-checked',false);}function pa(va,wa,xa,ya,za){if(xa){na(wa);}else oa(wa);var ab=la(wa);if(da(ab)){xa&&qa(va,ab);}else if(xa){if(!y[va].contains(ab))y[va].push(ab);}else{var bb=y[va].indexOf(ab);if(bb!==-1)y[va].splice(bb,1);}if(ya)ja(va,ab,za);}function qa(va,wa){x[va]=wa;g.inform('SubscriptionLevelUpdated',{profile_id:va,level:wa});}function ra(va,wa,xa,ya,za){var ab=j.scry(va,'.SubscriptionMenuLevel'),bb=null;ab.forEach(function(cb){if(la(cb)==xa){bb=cb;}else if(l.isItemChecked(cb))pa(wa,cb,false,false);});bb&&pa(wa,bb,true,ya,za);}function sa(va,wa,xa){t[wa]=xa;i.conditionClass(va,'isUnsubscribed',!xa);var ya=j.scry(va,'li.SubscribeMenuSubscribeCheckbox');if(ya.length!==0){var za=ya[0];if(xa){na(za);}else oa(za);}}function ta(va,wa){i.conditionClass(va,'subscriptionMenuOpen',wa);}g.subscribe('UnfollowUser',function(va,wa){if(z[wa.profile_id]){qa(wa.profile_id,z[wa.profile_id]);y[wa.profile_id]=aa[wa.profile_id].slice();}});g.subscribe('UpdateSubscriptionLevel',function(va,wa){var xa=wa.profile_id+'',ya=wa.level+'';qa(xa,ya);var za;for(za in r)if(r[za]===xa){var ab=k(za);ab&&ra(ab,xa,ya,false);}});var ua={init:function(va,wa,xa){var ya=j.getID(va);if(!r[ya])Event.listen(va,'click',function(za){return ea(va,r[ya],xa,za.getTarget());});if(x[wa])ka(va,wa);r[ya]=wa;i.conditionClass(va,'NonFriendSubscriptionMenu',!s[wa]);i.conditionClass(va,'cannotSubscribe',!u[wa]);i.conditionClass(va,'noSubscriptionLevels',v[wa]&&!w[wa]);i.conditionClass(va,'noSubscribeCheckbox',!s[wa]&&!v[wa]);sa(va,wa,t[wa]);g.subscribe(['FollowUser','FollowingUser','UnfollowUserFail'],function(za,ab){sa(va,wa,true);}.bind(this));g.subscribe(['UnfollowUser','UnfollowingUser','FollowUserFail'],function(za,ab){g.inform('SubMenu/Reset');sa(va,wa,false);}.bind(this));ta(va,false);},getSubscriptions:function(va){return {level:x[va],custom_categories:y[va]};},setSubscriptions:function(va,wa,xa,ya,za,ab,bb,cb,db,eb){qa(va,bb+'');s[va]=wa;t[va]=xa;u[va]=ya;v[va]=za;w[va]=ab;z[va]=db+'';y[va]=cb.map(String);aa[va]=eb.map(String);}};e.exports=a.EditSubscriptions||ua;});
__d("legacy:EditSubscriptions",["SubscriptionLevels","EditSubscriptions"],function(a,b,c,d){a.SubscriptionLevels=b('SubscriptionLevels');a.EditSubscriptions=b('EditSubscriptions');},3);
__d("DynamicFriendListEducation",["event-extensions","Arbiter","AsyncRequest","Dialog","PageTransitions","createArrayFrom"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Dialog'),j=b('PageTransitions'),k=b('createArrayFrom'),l,m,n,o,p,q;function r(){n&&n.hide();o&&o.hide();}function s(v){m.remove(v);r();p({accept_tag_education:true});}function t(){r();p({nux_cancel:true});}var u={init:function(v,w){l=v;m=k(w).map(String);j.registerHandler(function(){r();l=false;p=undefined;m=[];});},showDialog:function(v,w,x){if(l&&m.contains(v)){r();g.inform('DynamicFriendListEducation/dialogOpen',{uid:w,flid:v});p=x;n=new i().setAsync(new h('/ajax/friends/lists/smart_list_education.php').setMethod('GET').setData({flid:v,uid:w}).setReadOnly(true)).setHandler(s.bind(this,v)).setCloseHandler(function(){g.inform('DynamicFriendListEducation/dialogClosed',{uid:w,flid:v});}).setCancelHandler(function(){g.inform('DynamicFriendListEducation/dialogCancel',{uid:w,flid:v});}).show();}else x();},showContextualDialog:function(v,w,x,y){if(l&&m.contains(v)){r();q=x;p=y;new h('/ajax/friends/lists/smart_list_contextual_education.php').setMethod('GET').setData({flid:v,uid:w}).setReadOnly(true).send();}else y();},setContextualDialog:function(v,w,x,y){o=v;o.setContext(q);o.show();Event.listen(w,'click',s.bind(this,y));Event.listen(x,'click',t);}};e.exports=u;});
__d("FriendRequestMessage",[],function(a,b,c,d,e,f){var g={STATUS:'FriendRequest/change',UNFRIEND:'FriendRequest/unfriend',CANCEL:'FriendRequest/cancel',CANCELLING:'FriendRequest/cancelling',CANCEL_FAIL:'FriendRequest/cancelFail',SENT:'FriendRequest/sent',SENDING:'FriendRequest/sending',SEND_FAIL:'FriendRequest/sendFail',CONFIRM:'FriendRequest/confirm',CONFIRMING:'FriendRequest/confirming',CONFIRM_FAIL:'FriendRequest/confirmFail'};e.exports=g;});
__d("FriendStatus",["array-extensions","function-extensions","Arbiter","AsyncRequest","FriendRequestMessage","copyProperties","createArrayFrom"],function(a,b,c,d,e,f){b('array-extensions');b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('FriendRequestMessage'),j=b('copyProperties'),k=b('createArrayFrom');function l(p,q,r){this.id=p;this.update(q,r);}j(l.prototype,{update:function(p,q){p&&(this.status=p);if(q){this.lists=k(q).map(String);this._informListChange();}},isComplete:function(){return !!this.lists;},addToList:function(p){if(this.lists&&!this.lists.contains(p))this.lists.push(p);this._informListChange();},removeFromList:function(p){if(this.lists){var q=this.lists.indexOf(p);q!==-1&&this.lists.splice(q,1);}this._informListChange();},updateList:function(p,q){q?this.addToList(p):this.removeFromList(p);},_informListChange:function(){g.inform('FriendListMembershipChange',{uid:this.id,lists:this.lists});}});j(l,{ARE_FRIENDS:1,INCOMING_REQUEST:2,OUTGOING_REQUEST:3,CAN_REQUEST:4});var m={},n={};function o(p,q,r){if(!m[r.uid]){m[r.uid]=new l(r.uid,p);}else m[r.uid].update(p);g.inform(i.STATUS,{uid:r.uid,status:p});}g.subscribe([i.CANCEL,i.UNFRIEND,i.SEND_FAIL],o.curry(l.CAN_REQUEST));g.subscribe([i.CONFIRM_FAIL],o.curry(l.INCOMING_REQUEST));g.subscribe([i.CANCEL_FAIL,i.SENT,i.SENDING],o.curry(l.OUTGOING_REQUEST));g.subscribe([i.CONFIRM,i.CONFIRMING],o.curry(l.ARE_FRIENDS));j(l,{CLOSE_FRIENDS:null,ACQUAINTANCES:null,getFriend:function(p,q){if(m[p]&&m[p].isComplete()){q(m[p]);}else if(n[p]){n[p].push(q);}else{n[p]=[q];new h().setURI("/ajax/friends/status.php").setData({friend:p}).setHandler(function(r){var s=r.getPayload();l.initFriend.bind(l,p,s.status,s.lists).defer();}).send();}},initFriend:function(p,q,r){var s=m[p]||new l(p);s.update(s.status||q,s.lists||r);m[p]=s;n[p]&&n[p].forEach(function(t){t(s);});n[p]=null;},setSpecialLists:function(p){l.CLOSE_FRIENDS=p.close+'';l.ACQUAINTANCES=p.acq+'';}});e.exports=l;});
__d("FriendEditLists",["Arbiter","AsyncRequest","CSS","DOMQuery","DynamicFriendListEducation","EditSubscriptions","FriendRequestMessage","FriendStatus","Menu","Parent","ScrollableArea","URI","$","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOMQuery'),k=b('DynamicFriendListEducation'),l=b('EditSubscriptions'),m=b('FriendRequestMessage'),n=b('FriendStatus'),o=b('Menu'),p=b('Parent'),q=b('ScrollableArea'),r=b('URI'),s=b('$'),t=b('copyProperties'),u=b('ge'),v=5,w={},x="/ajax/profile/removefriendconfirm.php",y='/ajax/friends/requests/cancel.php',z;function aa(ka,la,ma){var na=w[ka.id],oa=function(pa){var qa={action:ma?'add_list':'del_list',to_friend:na.id,friendlists:[la],source:z};if(pa)t(qa,pa);na.updateList(la,ma);var ra;if(ma&&la==n.CLOSE_FRIENDS){ra=da(ka,n.ACQUAINTANCES);if(o.isItemChecked(ra)){o.toggleItem(ra);aa(ka,n.ACQUAINTANCES,false);}}else if(ma&&la==n.ACQUAINTANCES){ra=da(ka,n.CLOSE_FRIENDS);if(o.isItemChecked(ra)){o.toggleItem(ra);aa(ka,n.CLOSE_FRIENDS,false);}}var sa={flid:la,uid:na.id},ta=ma?'FriendListHovercard/add':'FriendListHovercard/remove';g.inform(ta,sa);new h().setURI('/ajax/add_friend/action.php').setData(qa).send();};if(ma){k.showDialog(la,na.id,oa);}else oa();}function ba(ka){var la=j.scry(ka,'input')[0];return la&&la.value;}function ca(ka,la,ma){var na={uid:la.id};new h().setURI(y).setMethod('POST').setData({friend:la.id}).setHandler(g.inform.bind(g,m.CANCEL,na)).setErrorHandler(g.inform.bind(g,m.CANCEL_FAIL,na)).setStatusElement(ma).send();}function da(ka,la){var ma=o.getItems(ka);for(var na=0;na<ma.length;na++)if(ba(ma[na])==la)return ma[na];return null;}function ea(ka,la){var ma=o.getItems(ka);ma.forEach(function(na){var oa=ba(na),pa=la.lists.contains(oa);if(o.isItemChecked(na)!==pa)o.toggleItem(na);});}function fa(ka){var la=o.getItems(ka),ma=!i.hasClass(ka,'followButtonFlyout')&&!i.hasClass(ka,'likeButtonFlyout'),na=[],oa=[],pa=0,qa=0;la.forEach(function(va){if(i.hasClass(va,'neverHide')){i.removeClass(va,'underShowMore');pa++;}else if(o.isItemChecked(va)){na.push(va);}else if(i.hasClass(va,'neverShow')||i.hasClass(va,'FriendListCreateTrigger')||(!ma&&i.hasClass(va,'friendOptionsOnly'))){i.addClass(va,'underShowMore');qa++;}else oa.push(va);});var ra=v-pa,sa=na.concat(oa),ta=qa;sa.forEach(function(va){if(i.hasClass(va,'ShowMoreItem')){ra--;return;}if(ra){i.removeClass(va,'underShowMore');ra--;}else{i.addClass(va,'underShowMore');ta=true;}});i.conditionClass(ka,'hasMoreFriendListItems',ta);var ua=j.scry(ka,'.FriendListMenuShowMore');ua.forEach(function(va){i.removeClass(va,'FriendListMenuShowMore');});}function ga(ka,la){var ma=j.scry(ka,'.FriendListUnfriend')[0],na=j.scry(ka,'.FriendListCancel')[0];if(na)i.conditionShow(na,la.status==n.OUTGOING_REQUEST);if(ma){i.conditionShow(ma,la.status==n.ARE_FRIENDS);j.find(ma,'a').setAttribute('ajaxify',r(x).addQueryData({uid:la.id}).toString());}}function ha(ka,la){var ma=j.scry(ka,'div.FriendListSubscriptionsMenu');if(ma.length!==0)l.init(ka,la,45);}var ia=function(){ia=bagofholding;g.subscribe(m.STATUS,function(ka,la){for(var ma in w){var na=u(ma),oa=w[ma];if(na&&oa&&oa.id==la.uid){ea(na,oa);ga(na,oa);fa(na);}}});o.subscribe('select',function(ka,la){if(i.hasClass(la.item,'ShowMoreItem')&&i.hasClass(la.menu,'FriendListMenu')){i.addClass(la.menu,'FriendListMenuShowMore');q.poke(la.item);}});},ja={init:function(ka,la,ma){ka=s(ka);z=ma;ia();if(!w[ka.id])o.subscribe('select',function(na,oa){if(j.contains(ka,oa.item))if(p.byClass(oa.item,'FriendListItem')){o.toggleItem(oa.item);var pa=ba(oa.item);aa(ka,pa,o.isItemChecked(oa.item));}else if(p.byClass(oa.item,'FriendListCancel')){ca(ka,w[ka.id],oa.item);}else if(p.byClass(oa.item,'FriendListUnfriend'))g.inform('FriendEditLists/unfriend');});i.addClass(ka,'async_saving');n.getFriend(la,function(na){ea(ka,na);ga(ka,na);w[ka.id]=na;fa(ka);ha(ka,la);i.removeClass(ka,'async_saving');}.bind(this));}};e.exports=a.FriendEditLists||ja;});
__d("FriendListFlyoutController",["event-extensions","Arbiter","AsyncRequest","Button","CSS","DataStore","Dialog","DOM","FriendEditLists","FriendStatus","Layer","Parent","ScrollableArea","UserAgent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Button'),j=b('CSS'),k=b('DataStore'),l=b('Dialog'),m=b('DOM'),n=b('FriendEditLists'),o=b('FriendStatus'),p=b('Layer'),q=b('Parent'),r=b('ScrollableArea'),s=b('UserAgent'),t,u,v=null,w=null,x,y,z,aa,ba,ca,da=1500,ea={init:function(ra){ea.init=bagofholding;t=ra;t.subscribe('mouseenter',fa);t.subscribe('mouseleave',ma);t.subscribe('hide',ga);if(v)m.setContent(t.getContent(),[v,w]);Event.listen(document.documentElement,'mouseover',function(sa){var ta=q.byClass(sa.getTarget(),'enableFriendListFlyout');if(ta)if(x===ta){clearTimeout(aa);}else{u&&oa();la(ta);}});g.subscribe('FriendEditLists/unfriend',oa);g.subscribe('DynamicFriendListEducation/dialogOpen',function(){ca=true;});g.subscribe('DynamicFriendListEducation/dialogClosed',function(){ca=false;ma();});},initContent:function(ra){m.appendContent(document.body,ra);(function(){if(!v){v=ra;t&&m.setContent(t.getContent(),[v,w]);j.show(v);Event.listen(v,'click',pa);u&&ja(x);}else{m.remove(ra);ra=null;}}).defer();},initNux:function(ra){if(w)return;w=ra;t&&m.setContent(t.getContent(),[v,w]);},show:function(ra){ka(ra);},hide:function(ra){ra===false?oa():ma();},setActiveNode:function(ra){u&&oa();x=ra;y=Event.listen(ra,'mouseleave',function(){x=null;y&&y.remove();});},setCloseListener:function(ra,sa){k.set(ra,'flfcloselistener',sa);if(x!=ra)k.set(ra,'flfcloselistenertimeout',qa.curry(ra).defer(da));},setCloseListenerTimeout:function(ra){da=ra;}};function fa(){clearTimeout(aa);}function ga(){if(x){j.removeClass(x,'selected');j.removeClass(x,'uiButtonHover');if(k.get(x,'flfcloselistener')){var ra=x;k.set(x,'flfcloselistenertimeout',qa.curry(ra).defer(da));}}u=false;ia();x=null;}function ha(ra){if(m.isNodeOfType(ra,'label')&&j.hasClass(ra,'uiButton'))ra=i.getInputElement(ra);return k.get(ra,'profileid');}function ia(){y&&y.remove();y=null;ba&&p.unsubscribe(ba);ba=null;aa&&clearTimeout(aa);aa=null;}function ja(ra){var sa=ha(ra),ta=k.get(ra,'flloc');n.init(v,sa,ta);j.conditionClass(v,'followButtonFlyout',j.hasClass(ra,'profileFollowButton'));j.conditionClass(v,'friendButtonFlyout',j.hasClass(ra,'FriendRequestFriends')||j.hasClass(ra,'FriendRequestIncoming')||j.hasClass(ra,'FriendRequestOutgoing'));j.conditionClass(v,'likeButtonFlyout',j.hasClass(ra,'profileLikeButton'));var ua=m.scry(v,'div.uiScrollableArea')[0];ua&&r.poke(ua);}function ka(ra){if(!t||u)return;t.setContext(ra);j.addClass(ra,'selected');j.addClass(ra,'uiButtonHover');t.setFixed(j.isFixed(ra)).show();x=ra;u=true;if(v){ja(ra);}else new h().setURI('/ajax/friends/lists/flyout_content.php').setStatusElement(t.getContent()).send();ia();y=Event.listen(ra,'mouseleave',ma);ba=p.subscribe('show',oa);if(k.get(ra,'flfcloselistener'))clearTimeout(k.remove(ra,'flfcloselistenertimeout'));var sa=ha(ra);o.getFriend(sa,function(ta){if(!w)return;if(ta.status==o.OUTGOING_REQUEST){j.show(w);h.bootstrap('/ajax/friends/lists/nux_flyout.php',null,true);}else j.hide(w);});}function la(ra){x=ra;z=ka.curry(ra).defer(350);y=Event.listen(ra,'mouseleave',function(){clearTimeout(z);x=null;y&&y.remove();});}function ma(){aa=oa.defer(150);}function na(){var ra=l.getCurrent(),sa=ra&&ra.getBody();return !!(sa&&m.scry(sa,'.friendListDialogTourCarousel')[0]);}function oa(){if(ca||na())return;s.ie()<8&&document.documentElement.focus();t&&t.hide();}function pa(event){var ra=q.byTag(event.getTarget(),'a');if(ra&&j.hasClass(ra,'FriendListActionItem'))ma();}function qa(ra){var sa=k.remove(ra,'flfcloselistener');sa&&sa();}e.exports=a.FriendListFlyoutController||ea;});
__d("legacy:FriendStatus",["FriendRequestMessage","FriendStatus"],function(a,b,c,d){a.FriendRequestMessage=b('FriendRequestMessage');a.FriendStatus=b('FriendStatus');},3);
var AddFriendButton={ERROR_ALREADY_ADDED:1431005,init:function(a,b,c,d,e,f,g,h,i,j,k){var l=null,m=DOM.scry(a,'.addButton')[0],n=DOM.scry(a,'.outgoingButton')[0],o=DOM.scry(a,'.incomingButton')[0],p=DOM.scry(a,'.friendButton')[0];function q(v,w,x){var y=new URI(m.getAttribute('ajaxify'));link_data=collect_data_attribs(a,['ft','gt']);new AsyncRequest().setURI(f).setData({to_friend:b,action:v,how_found:d,ref_param:e,link_data:link_data,outgoing_id:n.id,xids:y.getQueryData().xids,logging_location:g,no_flyout_on_click:h,ego_log_data:i,http_referer:k}).setErrorHandler(w).setServerDialogCancelHandler(x).setRelativeTo(n).send();}function r(v,w){m&&CSS.hide(m);n&&CSS.hide(n);o&&CSS.hide(o);p&&CSS.hide(p);if(v)CSS.show(v);if('Outgoing'==w&&l!=w&&j)animation(v).from('backgroundColor','#FFF8CC').to('backgroundColor','#FFFFFF').from('borderColor','#FFE222').to('borderColor','#FFFFFF').duration(2000).go();l&&CSS.removeClass(a,'fStatus'+l);l=w;CSS.addClass(a,'fStatus'+w);}function s(v){if(CSS.hasClass(v,'enableFriendListFlyout')){FriendListFlyoutController.show(v);}else FriendListFlyoutController.hide();}var t=Arbiter.subscribe(FriendRequestMessage.STATUS,function(v,w){if(w.uid!=b)return;switch(w.status){case FriendStatus.ARE_FRIENDS:return r(p,'Friends');case FriendStatus.INCOMING_REQUEST:return r(o,'Incoming');case FriendStatus.OUTGOING_REQUEST:return r(n,'Outgoing');case FriendStatus.CAN_REQUEST:return r(m,'Requestable');}}),u;if(c)u=Arbiter.subscribe(FriendRequestMessage.CONFIRM,function(v,w){w.uid==b&&goURI(c);});m&&Event.listen(m,'click',function(){Arbiter.inform(FriendRequestMessage.SENDING,{uid:b});if(h){FriendListFlyoutController.setActiveNode(n);}else s(n);q("add_friend",function(v){var w=v.error==AddFriendButton.ERROR_ALREADY_ADDED?FriendRequestMessage.SENT:FriendRequestMessage.SEND_FAIL;Arbiter.inform(w,{uid:b});FriendListFlyoutController.hide();AsyncResponse.defaultErrorHandler(v);},function(v){Arbiter.inform(FriendRequestMessage.SEND_FAIL,{uid:b});FriendListFlyoutController.hide();});});PageTransitions.registerHandler(function(){t.unsubscribe();u&&u.unsubscribe();});}};
__d("legacy:DynamicFriendListEducation",["DynamicFriendListEducation"],function(a,b,c,d){a.DynamicFriendListEducation=b('DynamicFriendListEducation');},3);
function StreamProfileComposer(){}copy_properties(StreamProfileComposer.prototype,{init:function(a){var b=$(a);Arbiter.subscribe('composer/publish',function(event,c){if(c.streamStory)animation.prependInsert(b,c.streamStory);});}});
__d("RespondToRequestButton",["event-extensions","CSS","Menu"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('Menu'),i={init:function(j,k,l,m){Event.listen(k,'click',function(){g.addClass(k,'uiButtonConfirm');g.addClass(k,'selected');l.show();});l.subscribe('hide',function(){g.removeClass(k,'uiButtonConfirm');g.removeClass(k,'selected');});h.subscribe('select',function(n,o){if(!g.hasClass(o.menu,'requestResponseMenu'))return;if(o.item.firstChild.getAttribute('data-profileid')!=j)return;if(g.hasClass(o.item,'reject')){g.hide(k);g.show(m);}l.hide();});}};e.exports=i;});
__d("legacy:RespondToRequestButton",["RespondToRequestButton"],function(a,b,c,d){a.RespondToRequestButton=b('RespondToRequestButton');},3);
__d("legacy:menu-legacy",["Menu"],function(a,b,c,d){a.Menu=b('Menu');},3);
var FriendButtonIcon={init:function(a,b,c){var d=DOM.find(b,'.defaultIcon'),e=DOM.find(b,'.closeIcon'),f=DOM.find(b,'.acqIcon');Arbiter.subscribe('FriendListMembershipChange',function(g,h){if(h.uid==c){var i=h.lists.contains(FriendStatus.CLOSE_FRIENDS),j=h.lists.contains(FriendStatus.ACQUAINTANCES);if(i&&!j){Button.setIcon(a,e);}else if(j&&!i){Button.setIcon(a,f);}else Button.setIcon(a,d);}});}};
var PageLikeButton=window.PageLikeButton||(function(){function a(b,c,d,e,f){fbpage_set_fan_status(b,c,d,false,function(){Arbiter.inform(PageLikeButton.LIKED_SUCCESS,{profile_id:c});},e,{fan_origin:f});}return {LIKED:'liked',UNLIKED:'unliked',LIKED_SUCCESS:'liked_success',init:function(b,c,d,e,f,g){Arbiter.subscribe(PageLikeButton.LIKED,function(h,i){if(e===i.profile_id)b.swap();});Arbiter.subscribe(PageLikeButton.UNLIKED,function(h,i){if(e===i.profile_id){b.unswap();d.hideFlyout();}});Event.listen(c,'click',function(event){a(event.getTarget(),e,true,function(){Arbiter.inform(PageLikeButton.UNLIKED,{profile_id:e});},f);Arbiter.inform(PageLikeButton.LIKED,{profile_id:e});if(g)Arbiter.subscribe(PageLikeButton.LIKED_SUCCESS,function(h,i){app_data=URI.getRequestURI().getQueryData().app_data;if(i.profile_id==e)new AsyncRequest().setURI('/ajax/pages/fetch_app_column.php').setData({profile_id:e,tab_key:g,app_data:app_data}).send();});});},initUnlike:function(b,c,d){Event.listen(b,'click',function(event){a(event.getTarget(),c,false,function(){Arbiter.inform(PageLikeButton.LIKED,{profile_id:c});},d);Arbiter.inform.bind(Arbiter,PageLikeButton.UNLIKED,{profile_id:c}).defer();});}};})();
var TimelineAggregatePost={init:function(a){Event.listen(a,'click',function(b){var c=b.getModifiers();if(b.isMiddleClick()||c.access||c.meta)return true;var d=Parent.byTag(b.getTarget(),'li');if(!CSS.hasClass(d,'wallPostMorePager'))new AsyncRequest().setURI(DataStore.get(d,'url')).send();});},initPage:function(a){Event.listen(a,'click',function(b){var c=Parent.byClass(b.getTarget(),'uiCloseButton');if(c)return;var d=Parent.byTag(b.getTarget(),'li');new AsyncRequest().setURI(DataStore.get(d,'url')).send();});},poke:function(a){ScrollableArea.poke(a);},setScrollHeight:function(a){var b=DOM.find(a,'.sArea');CSS.setStyle(b,'height',a.offsetHeight+'px');}};
__d("SwapButton",["event-extensions","copyProperties","CSS"],function(a,b,c,d,e,f){b('event-extensions');var g=b('copyProperties'),h=b('CSS');function i(j,k){if(j&&k){this._swapperButton=j;this._swappeeButton=k;Event.listen(j,'click',this.swap.bind(this));}}g(i.prototype,{_swapperButton:null,_swappeeButton:null,swap:function(){h.hide(this._swapperButton);h.show(this._swappeeButton);},unswap:function(){h.show(this._swapperButton);h.hide(this._swappeeButton);},init:function(j,k){this._swapperButton=j;this._swappeeButton=k;Event.listen(j,'click',this.swap.bind(this));}});e.exports=i;});
__d("HoverButton",["AsyncRequest","CSS","DOM","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('CSS'),i=b('DOM'),j=b('URI'),k=b('copyProperties');function l(m,n,o,p){if(m&&n){this._button=m;this._flyout=n;this._flyoutAjaxify=p;this._flyoutContent=o;n.subscribe('show',this._onShow.bind(this));n.subscribe('hide',this._onHide.bind(this));}}k(l.prototype,{_button:null,_flyout:null,_flyoutAjaxify:null,_flyoutContent:null,init:function(m,n,o,p){this._button=m;this._flyout=n;this._flyoutAjaxify=p;this._flyoutContent=o;n.subscribe('show',this._onShow.bind(this));n.subscribe('hide',this._onHide.bind(this));},showFlyoutBriefly:function(){this.showFlyout();this._flyout.hideFlyoutDelayed(5000);},showFlyout:function(){this._flyout.showFlyout(this._button,true);this._flyout.inform('show',this._button);},hideFlyout:function(){this._flyout.hideFlyout(true);this._flyout.inform('hide',this._button);},_onShow:function(m,n){h.addClass(n,'uiHoverButtonSelected');h.addClass(n,'selected');if(this._flyoutAjaxify){h.addClass(this._flyoutContent,'async_saving');new g().setURI(new j(this._flyoutAjaxify)).setHandler(function(o){h.removeClass(this._flyoutContent,'async_saving');i.setContent(this._flyoutContent,o.payload);}.bind(this)).send();this._flyoutAjaxify=null;}},_onHide:function(m,n){h.removeClass(n,'uiHoverButtonSelected');h.removeClass(n,'selected');},destroy:function(){this.hideFlyout();this._flyout.destroy();}});e.exports=l;});
__d("legacy:TooltipLink",["TooltipLink"],function(a,b,c,d){a.TooltipLink=b('TooltipLink');},3);
__d("StickyController",["event-extensions","CSS","Vector","Style","copyProperties","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('Vector'),i=b('Style'),j=b('copyProperties'),k=b('throttle');function l(m,n,o,p){this._element=m;this._marginTop=n;this._onchange=o;this._proxy=p||m.parentNode;}j(l.prototype,{handleScroll:function(){var m=h.getElementPosition(this._proxy,'viewport').y<=this._marginTop;if(this.isFixed()!==m){i.set(this._element,'top',m?this._marginTop+'px':'');g.conditionClass(this._element,'fixed_elem',m);this._onchange&&this._onchange(m);}},start:function(){if(this._event)return;this._event=Event.listen(window,'scroll',k(this.handleScroll,100,this));this.handleScroll.bind(this).defer();},stop:function(){this._event&&this._event.remove();this._event=null;},isFixed:function(){return g.hasClass(this._element,'fixed_elem');}});a.StickyController=e.exports=l;},3);
function fbpage_set_fan_status(a,b,c,d,e,f,g){e=e?e:function(j){_fbpage_show_change_status_feedback(a,j.getPayload());};var h={fbpage_id:b,add:c,reload:d};if(g!=null)copy_properties(h,g);var i=new AsyncRequest().setURI('/ajax/pages/fan_status.php').setData(h).setNectarModuleDataSafe(a).setHandler(e);if(f)i.setErrorHandler(f);i.send();return false;}function fbpage_set_favorite_status(a,b,c){var d=function(){_fbpage_show_change_status_feedback(a,this.getUserData());},e={fbpage_id:b,add:c},f=new AsyncRequest().setMethod('POST').setURI('/ajax/pages/favorite_status.php').setData(e);new Dialog().setAsync(f).setCloseHandler(d).show();return false;}function _fbpage_show_change_status_feedback(a,b){if(!b||!a)return;if(b.reload){fbpage_reload_on_fan_status_changed(b.preserve_tab);}else fbpage_redraw_on_fan_status_changed(a,b.feedback);}function fbpage_reload_on_fan_status_changed(a){var b=URI.getRequestURI();if(a){var c=FutureSideNav.getInstance().selected.textKey;if(!b.getQueryData().sk&&c)b.addQueryData({sk:c});}window.location.href=b;}function fbpage_redraw_on_fan_status_changed(a,b){if(!b)return;if(Parent.byClass(a,'fbTimelineEscapeSectionItem'))a=Parent.byClass(a,'fan_status_inactive')||a;var c=DOM.create('span',{className:'fan_status_inactive'},b);a.parentNode.replaceChild(c,a);var d=function(){if(data.can_repeat_action)c.parentNode.replaceChild(a,c);};animation(c).duration(3000).checkpoint().to('backgroundColor','#FFFFFF').duration(1000).ondone(d).go();}function fbpage_toggle_like_on_fan_status_changed(a,b){var c=$('liked_pages_like_action_'+a),d=$('liked_pages_undo_action_'+a);CSS.conditionClass(c,'hidden_elem',b);CSS.conditionClass(d,'hidden_elem',!b);}
__d("TimelineConstants",[],function(a,b,c,d,e,f){var g={DS_HEIGHT:'timeline-unit-height',DS_LOADED:'timeline-capsule-loaded',DS_SIDEORG:'timeline-unit-sideorg',DS_TAILBALANCE:'timeline-capsule-tailbalance',DS_COLUMN_HEIGHT_DIFFERENTIAL:'timeline-column-diff-height',FIXED_SIDE_LEFT:'left',FIXED_SIDE_RIGHT:'right',FIXED_SIDE_BOTH:'both',SCROLL_TO_OFFSET:30,SUBSECTION_SCROLL_TO_OFFSET:90};e.exports=g;});
__d("TimelineURI",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h={TIMELINE_KEY:'timeline',WALL_KEY:'wall',parseURI:function(i){i=g(i);var j=i.getQueryData(),k=i.getPath(),l=k.split('/').slice(1);if(l[0]=='people'||l[0]=='pages')l=l.slice(2);var m=j.sk||l[1]||h.TIMELINE_KEY;if(m==h.WALL_KEY)m=h.TIMELINE_KEY;var n=null,o=null;if(m==h.TIMELINE_KEY){o=parseInt(l[2],10)||null;n=parseInt(l[3],10)||null;}return {path:k,id:j.id||l[0],key:m,viewas:j.viewas?j.viewas:0,filter:j.filter?j.filter:null,year:o,month:n,friendship:!!j.and};}};e.exports=h;});
__d("TimelineController",["event-extensions","Arbiter","CSS","DataStore","DOM","Run","ScrollingPager","TimelineConstants","TimelineURI","Vector","$","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('DOM'),k=b('Run'),l=b('ScrollingPager'),m=b('TimelineConstants'),n=b('TimelineURI'),o=b('Vector'),p=b('$'),q=b('throttle'),r=484,s=48,t=740,u=1285,v=null,w=false,x,y,z={},aa={},ba=[],ca=null,da=0,ea=false,fa=false,ga=false,ha={allactivity:true,approve:true,games:true,map:true,music:true,video:true};ha[n.TIMELINE_KEY]=true;var ia=[],ja=false;function ka(ta,ua,va){va=va||[];if(z[ta])return z[ta][ua].apply(z[ta],va);aa[ta]=aa[ta]||{};aa[ta][ua]=va;return false;}function la(){if(!(ea||ga||fa)){ca.remove();ca=null;return;}var ta=o.getScrollPosition();ea=ea&&na(p('rightCol'),ta,'paddingTop',true);fa=fa&&na(p('pagelet_above_header_timeline'),ta,'top');ga=ga&&na(p('blueBar'),ta,'paddingTop');}function ma(){var ta=o.getScrollPosition(),ua=da===0||ta.y>=da;ka(sa.STICKY_HEADER,'toggle',[ua]);ka(sa.CONTENT,'checkCurrentSectionChange');}function na(ta,ua,va,wa){if(ua.y<=0){oa(ta,va);return false;}else{var xa=wa&&sa.getCurrentScrubber();if(xa&&h.hasClass(xa.getRoot(),'fixed_elem')){oa(ta,va);return false;}else{var ya=parseInt(ta.style[va],10)||0;if(ua.y<ya){h.addClass(ta,'timeline_fixed');ta.style[va]=ua.y+'px';}else h.removeClass(ta,'timeline_fixed');}}return true;}function oa(ta,ua){ta.style[ua]='0px';h.removeClass(ta,'timeline_fixed');}function pa(){ka(sa.ADS,'adjustAdsType',[sa.shouldShowWideAds()]);ka(sa.ADS,'adjustAdsToFit');ka(sa.CONTENT,'adjustContentPadding');ka(sa.STICKY_HEADER_NAV,'adjustMenuHeights');}function qa(ta,ua){if(ta=='sidebar/initialized')ja=true;ka(sa.ADS,'adjustAdsType',[sa.shouldShowWideAds()]);}function ra(){while(ba.length)ba.pop().remove();for(var ta in z)z[ta].reset&&z[ta].reset();ca&&ca.remove();ca=null;y.unsubscribe();y=null;v=null;x=null;z={};aa={};da=0;fa=false;if(ea){p('rightCol').style.paddingTop='';h.removeClass(p('rightCol'),'timeline_fixed');}ea=false;if(ga){p('blueBar').style.paddingTop='';h.removeClass(p('blueBar'),'timeline_fixed');}ga=false;ia=[];ja=false;w=false;i.purge(m.DS_HEIGHT);i.purge(m.DS_LOADED);i.purge(m.DS_SIDEORG);i.purge(m.DS_TAILBALANCE);i.purge(m.DS_COLUMN_HEIGHT_DIFFERENTIAL);}var sa={NAV:'nav',STICKY_HEADER:'sticky_header',STICKY_HEADER_NAV:'sticky_header_nav',SCRUBBER:'scrubber',CONTENT:'content',ADS:'ads',COVER:'cover',LOGGING:'logging',SECTION_LOADING:'TimelineController/sectionLoading',SECTION_LOADED:'TimelineController/sectionLoaded',SECTION_FULLY_LOADED:'TimelineController/sectionFullyLoaded',SECTION_REGISTERED:'TimelineController/sectionRegistered',SCRUBBER_DEFAULT_OFFSET:38,init:function(ta,ua){if(w)return;if(ua==n.WALL_KEY)ua=n.TIMELINE_KEY;w=true;x=ta;ka(sa.CONTENT,'adjustContentPadding');ba.push(Event.listen(window,'scroll',q(ma,100)),Event.listen(window,'resize',q(pa,100)));y=g.subscribe(['sidebar/initialized','sidebar/show','sidebar/hide'],qa);k.onLeave(ra);sa.registerCurrentKey(ua);},setAdsTracking:function(ta){ka(sa.ADS,'start',[ta]);},coverHasExpanded:function(ta){p('rightCol').style.paddingTop=ta+'px';ea=true;var ua=p('pagelet_above_header_timeline');if(ua.firstChild){p('above_header_timeline_placeholder').style.height=ua.offsetHeight+'px';ua.style.top=ta+'px';fa=true;}var va=document.documentElement;ga=va.clientHeight<400||va.clientWidth<va.scrollWidth;if(ga)p('blueBar').style.paddingTop=ta+'px';ca=Event.listen(window,'scroll',la);},pageHasScrubber:function(ta){return !ta||ta.match(/^(og_)?app_/)||(ta in ha);},registerCurrentKey:function(ta){v=ta;var ua=o.getViewportDimensions().y<t;ka(sa.ADS,'setShortMode',[ua,ta]);ka(sa.ADS,'updateCurrentKey',[ta]);da=ta==n.TIMELINE_KEY?r-s:0;},getCurrentKey:function(){return v;},getCurrentScrubber:function(){return z[sa.SCRUBBER];},getCurrentStickyHeaderNav:function(){return z[sa.STICKY_HEADER_NAV];},getSection:function(ta){return ka(sa.CONTENT,'getSection',[ta]);},scrubberHasLoaded:function(ta){ka(sa.STICKY_HEADER_NAV,'addTimePeriods',[ia]);ka(sa.ADS,'registerScrubber',[ta]);},registerSectionKey:function(ta,ua){if(sa.getCurrentScrubber()&&z[sa.STICKY_HEADER_NAV]){ka(sa.STICKY_HEADER_NAV,'addTimePeriod',[ta]);}else ia[ua]=ta;},scrubberHasChangedState:function(){ka(sa.ADS,'adjustAdsToFit');},scrubberWasClicked:function(ta){ka(sa.LOGGING,'logScrubberClick',[ta]);},sectionHasChanged:function(ta,ua){ka(sa.STICKY_HEADER_NAV,'updateSection',[ta,ua]);ka(sa.SCRUBBER,'updateSection',[ta,ua]);ka(sa.ADS,'loadAdsFromUserActivity');ka(sa.LOGGING,'logSectionChange',[ta,ua]);},navigateToSection:function(ta){ka(sa.CONTENT,'navigateToSection',[ta]);},shouldShowWideAds:function(){if(!ja)return false;var ta=u;if(a.ChatSidebar&&a.ChatSidebar.isVisible())ta+=a.ChatSidebar.getVisibleWidth();return o.getViewportDimensions().x>=ta;},sidebarInitialized:function(){return ja;},adjustStickyHeaderWidth:function(){ka(sa.STICKY_HEADER,'adjustWidth');},register:function(ta,ua){z[ta]=ua;if(aa[ta]){for(var va in aa[ta])ka(ta,va,aa[ta][va]);delete aa[ta];}},adjustScrollingPagerBuffer:function(ta,ua){var va=i.get(m.DS_COLUMN_HEIGHT_DIFFERENTIAL,ua);if(!va)return;var wa=l.getInstance(ta);wa&&wa.setBuffer(wa.getBuffer()+Math.abs(va));},runOnceWhenSectionFullyLoaded:function(ta,ua,va){if(ka(sa.CONTENT,'getSection',[ua])){var wa=false;j.scry(z[sa.CONTENT].getSection(ua).node,'ol.fbTimelineCapsule').forEach(function(ya){if(!wa&&i.get(m.DS_LOADED,ya.id)===va){ta();wa=true;}});if(wa)return;}var xa=g.subscribe(sa.SECTION_FULLY_LOADED,function(ya,za){if(za.scrubberKey===ua&&za.pageIndex===va){ta();xa.unsubscribe();}});}};e.exports=sa;});
__d("legacy:TimelineController",["TimelineController"],function(a,b,c,d){a.TimelineController=b('TimelineController');},3);
__d("TimelineDrag",["event-extensions","ArbiterMixin","Class","Locale","Style","Vector"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('Locale'),j=b('Style'),k=b('Vector');function l(m,n,o){o=o||{};this._listenOn=o.listenOn;this._offsetInput=n;this._defaultOffset=o.default_offset;this._killClicks=o.killClicks;this._vertical=true;this._RTLXSwitch=false;this.setPicture(m,o);}h.mixin(l,g,{setPicture:function(m,n){if(!m)return false;n=n||{};this._picture=m;this._defaultOffset=n.default_offset;if(n.vertical!==undefined)this._vertical=n.vertical;if(this._vertical){if(n.height)this._containerHeight=n.height;this._offsetType='top';this._eventCoord='y';}else{if(n.width)this._containerWidth=n.width;this._RTLXSwitch=i.isRTL();this._offsetType='left';this._eventCoord='x';}if(this._picture.complete){this._initialLoad();}else this._loadListener=Event.listen(this._picture,'load',function(){this._loadListener.remove();this._initialLoad();}.bind(this));},destroy:function(){this._stopDrag();this._saveOffset();this._mousedown&&this._mousedown.remove();this._onclick&&this._onclick.remove();this._loadListener&&this._loadListener.remove();},_initialLoad:function(){var m=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=Event.listen(m,'mousedown',this._onMouseDown.bind(this));if(this._vertical){this._maxOffset=this._containerHeight-this._picture.offsetHeight;}else this._maxOffset=this._containerWidth-this._picture.width;if(this._defaultOffset!==undefined)this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();if(this._killClicks)this._onclick=Event.listen(m,'click',this._onClick.bind(this));this._saveOffset();},_onClick:function(event){event.kill();},_onMouseDown:function(event){var m=parseInt(j.get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=m-k.getEventPosition(event)[this._eventCoord];this._startDrag();event.kill();},_startDrag:function(){if(!this._dragStarted){this.inform('startdrag',this);this._dragTokens=[Event.listen(document.documentElement,'mouseup',this._onMouseUp.bind(this)),Event.listen(document.documentElement,'mousemove',this._onMouseMove.bind(this))];this._dragStarted=true;}},_saveOffset:function(){var m=parseInt(j.get(this._picture,this._offsetType),10);if(this._RTLXSwitch){this._offsetInput.value=m+this._containerWidth-this._picture.offsetWidth;}else this._offsetInput.value=m;},_stopDrag:function(){if(this._dragStarted){this.inform('stopdrag',this);this._dragStarted=false;this._dragTokens.forEach(function(m){m.remove();});this._saveOffset();}},_onMouseUp:function(event){this._stopDrag();event.kill();},_setOffset:function(m){if(this._RTLXSwitch){m=Math.max(0,Math.min(m,-this._maxOffset));}else m=Math.min(0,Math.max(m,this._maxOffset));j.set(this._picture,this._offsetType,m+'px');},_onMouseMove:function(event){this._setOffset(this._pictureStartDragOffset+k.getEventPosition(event)[this._eventCoord]);event.kill();}});e.exports=l;});
__d("TimelineCover",["Button","CSS","DOM","HTML","Parent","DOMScroll","Vector","TimelineController","TimelineDrag","Style","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('HTML'),k=b('Parent'),l=b('DOMScroll'),m=b('Vector'),n=b('TimelineController'),o=b('TimelineDrag'),p=b('Style'),q=b('copyProperties'),r=b('ge');function s(){}s.instance=null;s.getInstance=function(){return s.instance;};q(s.prototype,{init:function(t,u,v){this.root=t;this._parentSection=k.byClass(this.root,'fbTimelineSection');this._coverHeight=u;this.cover=i.find(this.root,'.cover');s.instance=this;this.previewing=v;this.editing=false;if(v){this.updateCoverImage(v);}else if(this.cover.getAttribute('data-collapse'))this._expandCover(parseInt(this.cover.getAttribute('data-collapse'),10));if(this.previewing)this.editMode();n.register(n.COVER,this);},showLoadingIndicator:function(){var t=r('fbCoverImageContainer');if(t)h.addClass(t,'opaquedLoading');},hideLoadingIndicator:function(){var t=r('fbCoverImageContainer');if(t)h.removeClass(t,'opaquedLoading');},editMode:function(){g.setEnabled(i.find(this.root,'label.cancelButton'),true);g.setEnabled(i.find(this.root,'label.saveButton'),true);this.hideLoadingIndicator();this._coverImage=i.scry(this.root,'.coverImage')[0];var t=i.scry(this._coverImage,'.coverWrap')[0];if(t)this._originalOffset=p.get(i.find(t,'.coverPhotoImg'),'top');h.addClass(this._parentSection,'fbEditCover');l.scrollTo(i.getDocumentBodyElement());if(this.previewing){i.remove(this._coverImage);h.show(this._coverImage);}var u=i.scry(this._coverImage,'.coverPhotoImg')[0];if(u)this._createDragger();this.editing=true;},_expandCover:function(t){this.cover.style.marginTop='0px';if(t!=m.getScrollPosition().y){window.scrollBy(0,t);n.coverHasExpanded(t);}},_exitEditMode:function(){if(this._timelineDrag){this._timelineDrag.destroy();this._timelineDrag=null;}i.find(this.root,'input.hiddenPhotoID').value=null;g.setEnabled(i.find(this.root,'label.cancelButton'),false);g.setEnabled(i.find(this.root,'label.saveButton'),false);h.removeClass(this._parentSection,'fbEditCover');this.hideLoadingIndicator();},_createDragger:function(){this._timelineDrag=new o(i.find(this.root,'.coverImage .coverPhotoImg'),i.find(this.root,'input.photoOffsetInput'),{height:this._coverHeight,listenOn:this.cover,vertical:true,killClicks:true});},updateCoverImage:function(t,u){if(u)this.editMode();i.find(this.root,'input.hiddenPhotoID').value=t;g.setEnabled(i.find(this.root,'label.saveButton'),true);if(u)i.replace(i.find(this.root,'.coverImage'),j(u));if(this._timelineDrag){this._timelineDrag.setPicture(i.find(i.find(this.root,'.coverImage'),'.coverPhotoImg'));}else this._createDragger();},cancelUpdate:function(){i.remove(i.scry(this.root,'.coverImage')[0]);i.prependContent(this.cover,this._coverImage);if(this._originalOffset!==undefined)p.set(i.find(this._coverImage,'.coverPhotoImg'),'top',this._originalOffset);this._exitEditMode();},saveComplete:function(){this._coverImage=i.scry(this.root,'.coverImage')[0];this._exitEditMode();},isInEditMode:function(){return this.editing;}});a.TimelineCover=e.exports=s;},3);
var TimelineLogging=(function(){var a=false,b=0,c=null;return {init:function(d){if(a)return;b=d;TimelineController.register(TimelineController.LOGGING,this);},reset:function(){a=false;b=0;c=null;},log:function(d,e){e.profile_id=b;report_data(d,{gt:e});},logSectionChange:function(d,e){var f={timeline_section_change:1,key:d};if(c&&d==c){f.timeline_scrubber=1;c=null;}TimelineLogging.log('timeline',f);},logScrubberClick:function(d){c=d;}};})();
__d("legacy:TimelineURI",["TimelineURI"],function(a,b,c,d){a.TimelineURI=b('TimelineURI');},3);
var TimelineNavigation=(function(){var a=4,b=110,c=20,d=119,e=328,f=10,g=3,h=false,i=21,j,k,l,m=[],n=[],o,p=0,q,r=0,s=0,t,u=a,v=false,w=false,x,y=false,z,aa,ba=false;function ca(pa,qa,ra){if(!qa.firstChild){DOM.remove(qa);return;}n.push(qa);fa(ra.recent);CSS.removeClass(Parent.byTag(qa,'li'),'empty');if(o&&(r>a||s>0))CSS.removeClass(o,'notready');ea();if(ra.async){ja();la();}}function da(pa,qa,ra){DOM.remove(Parent.byTag(qa,'li'));if(!ra.async){t++;}else{r--;ja();la();}ea();}function ea(){var pa=o?0:i;if(r<=a){var qa=e+d*Math.max(0,a-r)+pa;q.style.width=qa+'px';u=r;ga();}}function fa(pa){if(pa){s++;}else r++;ga();}function ga(){if(!z)return;var pa=Math.max(0,r-a)+s;if(p&&o){DOM.setContent(p,pa===0?" ":pa);CSS.conditionClass(o,'fbTimelineMoreButtonZero',pa===0);if(!v)CSS.conditionShow(o,pa>0);}}function ha(){var pa=DOM.scry($('fbTimelineNavTopRow'),'li.tile'),qa=0,ra=0,sa=Math.max(0,a-u),ta=false;for(var ua=0;ua<pa.length;ua++){if(pa[ua]==q||pa[ua]==o)continue;ta=((qa+sa)%a===0);CSS.conditionClass(pa[ua],'leftMost',(qa!==0&&ta));if(!CSS.hasClass(pa[ua],'empty'))ra=qa;qa++;}ta=((ra+1+sa)%a===0);var va=pa.length-1-sa;if(ta){if(v&&(ra+1+sa)/a<g){va=Math.min(va,ra+a);w=true;}else va=ra;}else{var wa=((ra+1+sa)%a);va=ra+(a-wa);w=false;}ua=0;for(ua=0;ua<=va;ua++)if(pa[ua]&&(pa[ua]==q||pa[ua]==o)){va++;}else pa[ua]&&CSS.hasClass(pa[ua],'empty')&&CSS.removeClass(pa[ua],'hidden_elem');}function ia(pa,qa,ra){var sa=DOM.scry(pa,'li.tile');if(!qa)qa=0;var ta=false;for(var ua=qa;ua<sa.length;ua++){ta=((ua-ra)%a===0);var va=sa[ua];CSS.conditionClass(va,'leftMost',ta);if(CSS.hasClass(va,'empty'))CSS.removeClass(va,'hidden_elem');}}function ja(){ha();var pa=ge('fbTimelineNavSecondaryRow');pa&&ia(pa,0,0);}function ka(){if(!o)return;if(CSS.hasClass(o,'notready'))return;CSS.toggleClass(o,'fbTimelineMoreButtonOpen');var pa=ge('fbRecentAppTitle');pa&&CSS.conditionClass(pa,'hidden_elem',s===0);if(CSS.hasClass(o,'fbTimelineMoreButtonOpen')){ja();}else ga();la();}function la(){if(o&&!CSS.hasClass(o,'fbTimelineMoreButtonOpen')){j.style.height='';CSS.removeClass(j,'expanded');}else{var pa=r+(a-u),qa=((s>0)?f:0)+b*(Math.ceil(s/a))+b*(Math.ceil(pa/a))+b*(w?1:0)+c;CSS.addClass(j,'expanded');j.style.height=qa+'px';}}function ma(pa){var qa=pa==TimelineURI.TIMELINE_KEY||pa==TimelineURI.WALL_KEY,ra=Parent.byClass(j,'fbTimelineTopSectionBase'),sa=ge('timeline_tour_toolbar');if(o){CSS.removeClass(o,'fbTimelineMoreButtonOpen');la();}sa&&CSS.conditionShow(sa,qa);if(ra)CSS.conditionClass(ra,'collapsedHead',!qa);}function na(event){if(ba)return true;if(!Parent.byTag(event.getTarget(),'a')){var pa=DOM.find(q,'a.title');PageTransitions.go(pa.href);}}function oa(){if(o)(function(){o.removeAttribute('ajaxify');o.removeAttribute('rel');}).defer();_removeAjaxifyRef.remove();}return {UPDATE_PAGE:'TimelineNavigation/updatePage',init:function(pa,qa,ra,sa){if(h)return;h=true;j=pa;o=qa;k=URI.getRequestURI();q=DOM.find(j,'li.about');ma(TimelineController.getCurrentKey());v=sa;Arbiter.inform(TimelineNavigation.UPDATE_PAGE);if(o){p=DOM.find(o,'div.text');_removeAjaxifyRef=Event.listen(o,'click',oa);}x=$('fbTimelineNavigationLoadContainer');DOM.appendContent($('content'),x);aa=Event.listen(q,'click',na);m.forEach(function(ua){if(!ua[2].remove){ca.apply(this,ua);}else da.apply(this,ua);});m=[];var ta=Parent.byClass(pa,'fbTimelineSection');if(ta)DOM.scry(ta,'ul.uiButtonGroup').forEach(function(ua){$A(ua.childNodes).forEach(function(va){va.childNodes.length||DOM.remove(va);});if(ua.firstChild){CSS.addClass(ua.firstChild,'firstItem');}else DOM.remove(ua);});TimelineController.register(TimelineController.NAV,TimelineNavigation);},reset:function(){aa&&aa.remove();aa=null;z&&z.remove();z=null;h=false;j=null;l=null;n=[];o=null;p=null;q=null;r=0;s=0;t=0;u=a;v=false;w=false;x=null;y=false;ba=false;},initializeMorePager:function(){if(z)return;if(o)z=Event.listen(o,'click',ka);},registerNav:function(pa,qa,ra){h?(ra.remove?da.apply(this,arguments):ca.apply(this,arguments)):m.push(arguments);},redraw:function(){ja();la();},setEditMode:function(pa){ba=pa;}};})();
var TimelineSideAds=(function(){var a=2,b=3,c=75,d='data-height',e=30000,f=false,g,h,i,j=[],k,l=false,m,n=Infinity,o=5,p=false,q,r,s,t,u=false;function v(la,ma,na){var oa=ma.getHeight();if(!oa)return;la-=oa;var pa=0;for(var qa=0;qa<na;qa++)pa+=ea(qa);if(la<pa){la+=ma.fold(pa-la);}else if(la>pa)la-=ma.unfold(la-pa);return la;}function w(){var la=g.cloneNode(true);la.id='';var ma=true;DOM.scry(la,'div.ego_unit').forEach(function(na){if(ma){ma=false;}else DOM.remove(na);});CSS.addClass(la,'fixed_elem');return la;}function x(){if(!TimelineController.pageHasScrubber(k)){aa(o);ca();}else if(r){ba(g,false);var la=s;s&&DOM.remove(s);s=w();if(la)ja();aa(TimelineController.sidebarInitialized()&&l?b:a);ca();if(!m){var ma=TimelineController.getCurrentScrubber();ma&&ia(ma);}m&&m.start();}else TimelineSideAds.adjustAdsToFit();}function y(){if(s){DOM.remove(s);s=null;}if(m){m.stop();m=null;}CSS.conditionClass(g,'fixed_elem',!r&&TimelineController.pageHasScrubber(k));}function z(la){var ma=Vector2.getViewportDimensions().y,na=TimelineController.getCurrentScrubber(),oa=na?na.getOffset():TimelineController.SCRUBBER_DEFAULT_OFFSET,pa=ma-oa-c;if(na)return v(pa,na,la);}function aa(la){i=Math.min(la,j.length);for(var ma=0;ma<j.length;ma++)ba(j[ma],ma>=i);ba(g,i===0);}function ba(la,ma){CSS.conditionClass(la,'fbTimelineSideAdsOffScreen',ma);la.setAttribute('aria-hidden',ma?'true':'false');}function ca(){for(var la=i-1;la>=0;--la){if(m&&m.isFixed()&&((la!==0)||(s&&!CSS.shown(s))))continue;var ma=DOM.find(j[la],'div.fbAdUnit'),na=ma.getAttribute('data-ad'),oa=JSON.parse(na).adid;if(!t[oa])return;var pa=$N('iframe',{src:URI('/ai.php').addQueryData({aed:t[oa]}),width:0,height:0,frameborder:0,scrolling:'no',className:'fbEmuTracking'});pa.setAttribute('aria-hidden','true');DOM.appendContent(g,pa);delete t[oa];}}function da(la){var ma=0;while(la>0&&ma<o){la-=ea(ma);if(la>=0)ma++;}return ma;}function ea(la){var ma=j[la];if(!ma)return 0;if(!ma.getAttribute(d))fa(ma);return parseInt(ma.getAttribute(d),10);}function fa(la){la.setAttribute(d,la.offsetHeight);}function ga(){for(var la=0;la<j.length;la++){var ma=j[la];if(!ma)continue;fa(ma);}}function ha(){j=DOM.scry(g,'div.ego_unit');var la=j.length;if(!la)return;p=la;x();var ma=function(na){fa(na);p=--la;TimelineSideAds.adjustAdsToFit();if(!p)n=Date.now();};j.forEach(function(na){function oa(){ma.curry(na).defer();}var pa=DOM.scry(na,'img.img')[0];if(pa.complete){oa();}else Event.listen(pa,{load:oa,error:oa,abort:oa});});}function ia(la){m=new StickyController(la.getRoot(),la.getOffset(),function(ma){if(ma){ja();}else{DOM.remove(s);ca();}});if(s)m.start();}function ja(){DOM.insertAfter(g,s);ka();}function ka(){CSS.conditionShow(s,ea(0)<=z(1)&&!CSS.hasClass(document.documentElement,'tinyViewport'));}return {init:function(la,ma,na){if(f)return;o=na;f=true;h=ma;g=la;TimelineSideAds.adjustAdsType(TimelineController.shouldShowWideAds());TimelineController.register(TimelineController.ADS,TimelineSideAds);},setShortMode:function(la,ma){r=ma!=='map'&&la&&TimelineController.pageHasScrubber(ma);},start:function(la){t=la;q=null;ha();},updateCurrentKey:function(la){if(la==k)return;k=la;y();},loadAds:function(la){if(p||q)return;n=Infinity;q=UIPagelet.loadFromEndpoint('WebEgoPane',g.id,{pid:33,data:[h,false,'timeline_'+la,r?b:o]},{crossPage:true});},registerScrubber:function(la){CSS.conditionClass(la.getRoot(),'fixed_elem',!r);if(r)ia(la);!q&&TimelineSideAds.adjustAdsToFit();},loadAdsFromUserActivity:function(){if((Date.now()-n>=e)&&!CSS.hasClass(document.documentElement,'tinyViewport')&&(!m||m.isFixed())&&(!t||!t[j[0]]))TimelineSideAds.loadAds(k+'_refresh');TimelineSideAds.adjustAdsToFit();},adjustAdsType:function(la){if(la!=l){CSS.conditionClass(g,'fbTimelineVerticalAds',!la);s&&CSS.conditionClass(s,'fbTimelineVerticalAds',!la);l=la;ga();TimelineSideAds.adjustAdsToFit();}},adjustAdsToFit:function(){if(!g||u)return;u=true;var la=l?b:a;if(r){if(m&&s){m.handleScroll();if(m.isFixed()){CSS.conditionShow(s,ea(0)<=z(1)&&!CSS.hasClass(document.documentElement,'tinyViewport'));}else aa(la);ca();}}else{var ma=z(la);if(typeof ma!=='undefined'){aa(da(ma));if(!p)ca();}}u=false;},reset:function(){m&&m.stop();q&&q.cancel();j=[];l=false;g=null;m=null;q=null;p=null;r=null;s=null;k=null;f=false;}};})();
__d("TimelineStickyHeader",["Arbiter","CSS","DOM","TimelineController"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('TimelineController'),k=false,l=false,m,n,o,p={VISIBLE:'TimelineStickyHeader/visible',ADJUST_WIDTH:'TimelineStickyHeader/adjustWidth',init:function(q){if(k)return;k=true;m=q;n=i.find(q,'div.name');o=i.find(q,'div.actions');j.register(j.STICKY_HEADER,p);},reset:function(){k=false;l=false;m=null;n=null;o=null;},toggle:function(q){h.conditionClass(m,'fbTimelineStickyHeaderHidden',!q);if(q!==l){l=q;g.inform(p.VISIBLE,q);}},adjustWidth:function(){g.inform(p.ADJUST_WIDTH,n,g.BEHAVIOR_STATE);},getRoot:function(){return m;},setActions:function(q){if(k&&q){i.replace(o,q);o=q;}}};e.exports=a.TimelineStickyHeader||p;});
__d("legacy:TimelineStickyHeader",["TimelineStickyHeader"],function(a,b,c,d){a.TimelineStickyHeader=b('TimelineStickyHeader');},3);
__d("TimelineStickyHeaderNav",["array-extensions","event-extensions","function-extensions","Arbiter","ButtonGroup","CSS","DOM","Parent","Selector","Style","TimelineController","URI","UserAgent","Vector","ge"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('ButtonGroup'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Selector'),m=b('Style'),n=b('TimelineController'),o=b('URI'),p=b('UserAgent'),q=b('Vector'),r=b('ge'),s=false,t,u,v,w,x,y,z,aa,ba,ca,da,ea={},fa={},ga=[],ha=false,ia=[],ja=[],ka=[],la=[];function ma(event){var ab=k.byTag(event.getTarget(),'a');if(ab){n.navigateToSection(ab.getAttribute('data-key'));event.prevent();}}function na(ab,bb){var cb=l.getValue(bb);if(cb==='allStories')n.getSection(ab).expandSubSections();if(cb!=='activityLog')oa(bb);}function oa(ab){xa(ab,'highlights');xa(ab,'allStories');var bb=j.find(ab,'li.separator');i.conditionShow(bb,bb.previousSibling);}function pa(ab){if(ba[ab]&&!u.custom_subsection_menu){ua(ab);}else sa();n.adjustStickyHeaderWidth();}function qa(ab,bb){var cb=bb.key;if(ca[cb]){va(cb);pa(cb);}}function ra(ab,bb){var cb=bb.scrubberKey;va(cb);if(v===cb)pa(cb);}function sa(){w.hideItem(z);}function ta(ab){var bb=aa[ab],cb=ba[ab];if(!bb&&cb){bb=aa[ab]=z.cloneNode(true);var db=j.scry(bb,'li.activityLog a')[0];if(db)db.href=o(db.href).addQueryData({key:ab});var eb=n.getCurrentScrubber();if(cb.length)i.show(j.find(bb,'li.separator'));for(var fb=0;fb<cb.length;fb++){var gb=cb[fb].scrubberKey,hb=eb.getLabelForSubnav(cb[fb].parentKey,gb);if(hb)wa(bb,{key:gb,label:hb});}if(ya()){oa(bb);l.setSelected(bb,j.scry(bb,'option')[1].value,true);}la.push(l.listen(bb,'change',na.curry(ab,bb)));ja.push(Event.listen(bb,'click',ma));}return bb;}function ua(ab){var bb=ta(ab);j.insertAfter(z,bb);i.hide(z);for(var cb in aa){var db=aa[cb];i.conditionShow(db,db===bb);}w.showItem(z);}function va(ab){ba[ab]=n.getSection(ab).subSections;}function wa(ab,bb){var cb=j.create('a',{href:'#',rel:'ignore',className:'itemAnchor',tabIndex:0},j.create('span',{className:'itemLabel fsm'},bb.label));cb.setAttribute('data-key',bb.key);cb.setAttribute('aria-checked',false);var db=j.create('li',{className:'uiMenuItem uiMenuItemRadio uiSelectorOption'},cb);db.setAttribute('data-label',bb.label);var eb=j.find(ab,'ul.uiMenuInner'),fb=j.create('option',{value:bb.key},bb.label),gb=j.find(ab,'select');if(bb.key==='recent'){j.prependContent(eb,db);j.insertAfter(gb.options[0],fb);}else{j.appendContent(eb,db);j.appendContent(gb,fb);}}function xa(ab,bb){var cb=j.scry(ab,'li.uiMenuItem');if(!cb)return;for(var db=0;db<cb.length;db++){var eb=cb[db];if(i.hasClass(eb,bb)||eb.firstChild.getAttribute('data-key')==bb){j.remove(eb);break;}}var fb=j.find(ab,'select'),gb=j.scry(fb,'option');for(db=0;db<gb.length;db++)if(gb[db].value===bb){j.remove(gb[db]);return;}}function ya(){return n.getCurrentKey()==='allactivity'||n.getCurrentKey()==='approve';}var za={init:function(ab,bb){if(s)return;s=true;t=ab;u=bb||{};x=j.find(t,'div.pageMenu');y=j.find(t,'div.sectionMenu');z=j.find(t,'div.subsectionMenu');da=j.find(x,'li.uiMenuSeparator');w=h.getInstance(x);aa={};ba={};ca={};za.adjustMenuHeights();n.register(n.STICKY_HEADER_NAV,za);},reset:function(){s=false;u={};ga=[];ea={};fa={};ha=false;ia=[];t=null;x=null;y=null;z=null;da=null;aa={};ba={};ca={};while(ja.length)ja.pop().remove();ka.forEach(g.unsubscribe);la.forEach(l.unsubscribe.bind(l));},addTimePeriods:function(ab){if(!ab.length)return;if(u.pull_from_scrubber){j.setContent(j.find(y,'ul.uiMenuInner'),'');j.remove(j.find(y,'select').children[1]);while(ab.length){var bb=ab.shift();bb&&za.addTimePeriod(bb);}w.showItem(y);}var cb=l.getSelectorMenu(y);ja.push(Event.listen(cb,'click',ma));var db=ya()?n.SECTION_REGISTERED:n.SECTION_LOADED,eb=ya()?ra:qa;ka.push(g.subscribe(db,eb));},addTimePeriod:function(ab){var bb=n.getCurrentScrubber().getLabelForNav(ab);if(!bb)return;wa(y,{key:ab,label:bb});var cb=j.find(y,'ul.uiMenuInner');if(ab==='recent'||cb.children.length<2)l.setSelected(y,ab,true);},updateSection:function(ab,bb){if(bb){var cb=ta(ab);if(cb){l.setSelected(cb,bb);oa(cb);}else v=ab;}else{ca[ab]=true;va(ab);}l.setSelected(y,ab,true);pa(ab);},adjustMenuHeights:function(){if(p.ie()<=7)return;[x,y].forEach(function(ab){var bb='';if(!i.hasClass(document.documentElement,'tinyViewport')){bb=q.getViewportDimensions().y-q.getElementDimensions(r('blueBar')).y-80;bb+='px';}m.set(j.find(ab,'ul.uiMenuInner'),'maxHeight',bb);});},initPageMenu:function(ab,bb){function cb(db,eb){db.forEach(function(fb){var gb=fa[fb]=j.create('li');i.hide(gb);eb?j.insertBefore(da,gb):j.appendContent(j.find(x,'ul.uiMenuInner'),gb);});}cb(ab,true);cb(bb,false);ea.info=j.scry(x,'li')[0];ga=bb;ha=true;if(ia.length)ia.forEach(function(db){za.registerPageMenuItem(db.key,db.item);});},registerPageMenuItem:function(ab,bb){if(!ha){ia.push({key:ab,item:bb});return;}if(fa[ab]){j.replace(fa[ab],bb);ea[ab]=bb.getNodes()[0];delete fa[ab];if(ga.indexOf(ab)>=0)i.show(da);}},removeTimePeriod:function(ab){xa(y,ab);}};e.exports=za;});
__d("legacy:TimelineStickyHeaderNav",["TimelineStickyHeaderNav"],function(a,b,c,d){a.TimelineStickyHeaderNav=b('TimelineStickyHeaderNav');},3);
__d("legacy:TimelineThrottler",["TimelineThrottler"],function(a,b,c,d){a.TimelineThrottler=b('TimelineThrottler');},3);
__d("legacy:TimelineCover",["TimelineCover"],function(a,b,c,d){a.TimelineCover=b('TimelineCover');},3);
__d("HubsTypeaheadView",["Class","ContextualTypeaheadView","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('ContextualTypeaheadView'),i=b('copyProperties');function j(k,l){this.parent.construct(this,k,l);}g.extend(j,h);i(j.prototype,{render:function(k,l,m){if(this.alwaysRender&&k!==''){var n=k.toLowerCase().trim(),o=false;for(var p=0;p<l.length;p++)if(n==l[p].text.toLowerCase()){o=true;break;}if(!o)l.push({text:k,type:'calltoaction'});}return this.parent.render(k,l,m);}});e.exports=j;});
__d("legacy:HubsTypeaheadView",["HubsTypeaheadView"],function(a,b,c,d){a.HubsTypeaheadView=b('HubsTypeaheadView');},3);
__d("TypeaheadSetPhotoOnSelect",["event-extensions","function-extensions","CSS","DOM","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('CSS'),h=b('DOM'),i=b('copyProperties');function j(k){this._typeahead=k;}i(j.prototype,{_eventListener:null,_subscription:null,enable:function(){var k=h.scry(this._typeahead.getElement(),'.photo')[0];if(k){if(!h.isNodeOfType(k,'img')){var l=h.create('img',{className:k.className});h.replace(k,l);k=l;}var m=g.hide.curry(k),n=g.show.curry(k);this._eventListener=Event.listen(k,{load:n,error:m,abort:m});this._subscription=this._typeahead.subscribe('select',function(o,p){var q=p.selected.photo||this._typeahead.view.fallbackPhoto;q?k.setAttribute('src',q):m();}.bind(this));}},disable:function(){this._eventListener.remove();this._eventListener=null;this._typeahead.unsubscribe(this._subscription);this._subscription=null;}});e.exports=j;});
__d("legacy:SetPhotoOnSelectTypeaheadBehavior",["TypeaheadSetPhotoOnSelect"],function(a,b,c,d){var e=b('TypeaheadSetPhotoOnSelect');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.setPhotoOnSelect=function(f){f.enableBehavior(e);};},3);
__d("legacy:LayerHideOnBlur",["LayerHideOnBlur"],function(a,b,c,d){a.LayerHideOnBlur=b('LayerHideOnBlur');},3);
__d("TimelinePerfConfig",["Util"],function(a,b,c,d,e,f){var g=b('Util'),h=null,i=function(){if(h===null)return false;return true;},j={init:function(k){h=k;},getDisablePageletThrottle:function(){return i()&&(h.disablePageletThrottle||h.disableAllThrottle);},getDisableAllThrottle:function(){return i()&&h.disableAllThrottle;},getDisableSpineHeight:function(){return i()&&h.disableSpineHeight;}};e.exports=j;});
__d("TimelineSmartInsert",["CSS","DOM","Run","UserAgent","Vector"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Run'),j=b('UserAgent'),k=b('Vector'),l=false,m=false;function n(){if(m)return;i.onLeave(o);m=true;}function o(){l=false;m=false;}var p={BUFFER:100,run:function(q,r){n();if(!l||j.ie()<=8){r();return;}var s=q.offsetHeight;r();var t=q.offsetHeight;if(t-s!==0&&k.getElementPosition(q).y+s<k.getScrollPosition().y+p.BUFFER)window.scrollBy(0,t-s);},enable:function(){l=true;}};e.exports=p;});
__d("TimelineThrottler",["event-extensions","Arbiter","TimelinePerfConfig","copyProperties","debounce","throttle"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('TimelinePerfConfig'),i=b('copyProperties'),j=b('debounce'),k=b('throttle');function l(m){this.id=m;this.idle=true;this.keys={};this.queue=[];this.config={};this.configure();l.instances[m]=this;}l.getInstance=function(m){return l.instances[m]||new l(m);};l.instances={};l.config={};l.REQUEUE='requeue';g.subscribe("Timeline/throttle",function(m,n){l.config=n;for(var o in l.instances)l.instances[o].configure();});i(l.prototype,{configure:function(){if(this._handle)this._handle.remove();var m=j(function(){this.idle=true;this._process();},l.config.scrollDelay||400,this),n=k(function(){this.idle=false;m();},l.config.scrollThrottle||100,this);this._handle=Event.listen(window,'scroll',n);i(this.config,l.config[this.id]);},cancel:function(){this.idle=true;this.keys={};this.queue=[];this.config={};this._handle&&this._handle.remove();},_limit:function(m,n,o){if(h.getDisableAllThrottle()){m();return;}var p=m;if(n){if(this.keys[n])if(o){this.queue.splice(this.queue.indexOf(this.keys[n]),1);}else return;this.keys[n]=m;p=function(){delete this.keys[n];m();}.bind(this);}this.queue.push(p);this._process();},throttle:function(m,n){this._limit(m,n,false);},debounce:function(m,n){this._limit(m,n,true);},_process:function(){if(this.idle&&this.queue.length){var m=this.queue.shift(),n=m();if(n===l.REQUEUE)this.queue.push(m);setTimeout(this._process.bind(this),this.config.delay||0);}}});e.exports=l;});
__d("TimelineContentLoader",["Arbiter","CSS","DOM","DOMScroll","OnVisible","ScrollingPager","TimelineConstants","TimelineController","TimelinePerfConfig","TimelineSmartInsert","TimelineThrottler","TimelineURI","UIPagelet","UserAgent","Vector","$","copyProperties","createArrayFrom","debounce","ge","startsWith","tx","userAction"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('DOMScroll'),k=b('OnVisible'),l=b('ScrollingPager'),m=b('TimelineConstants'),n=b('TimelineController'),o=b('TimelinePerfConfig'),p=b('TimelineSmartInsert'),q=b('TimelineThrottler'),r=b('TimelineURI'),s=b('UIPagelet'),t=b('UserAgent'),u=b('Vector'),v=b('$'),w=b('copyProperties'),x=b('createArrayFrom'),y=b('debounce'),z=b('ge'),aa=b('startsWith'),ba=b('tx'),ca=b('userAction'),da=false,ea=false,fa,ga={},ha=null,ia={},ja=[],ka=[],la={},ma={},na={},oa=null,pa=null,qa=null,ra=false,sa=null;function ta(eb,fb,gb,hb,ib){this.node=eb;this.loaded=hb;this.canScrollLoad=true;this.canUnload=fb!=db.RECENT;this.scrubberKey=fb;this.historicUnitCount=ib;this._pageletLoadData=gb;this._expandPageletLoadData={};}w(ta.prototype,{load:function(eb){if(this.loaded)return;var fb=this._pageletLoadData;g.inform(n.SECTION_LOADING,{data:fb,scrubberKey:this.scrubberKey});this.loaded=true;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var gb='ProfileTimelineSectionPagelet';if(this.scrubberKey==db.WAY_BACK)gb='ProfileTimelineRemainingYearsPagelet';fb.time_cutoff=db.getTimeCutoff();fb.highlight_unit_data=eb;fb.parent_key=this.parentKey;fb.force_no_friend_activity=ra;h.addClass(this.node,'fbTimelineSectionLoading');var hb=null;if(!eb&&!o.getDisablePageletThrottle())hb=xa.curry(this.node);if(this.canUnload&&ea){var ib=this.node.firstChild.cloneNode(true);h.hide(ib);i.insertAfter(this.node,ib);}else this.canScrollLoad=false;na[this.scrubberKey]=s.loadFromEndpoint(gb,this.node.id,fb,{usePipe:true,jsNonblock:true,constHeight:true,displayCallback:hb});cb(this.scrubberKey);},preload:function(){h.addClass(this.node,'fbTimelineTimePeriodSuppressed');h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var eb=i.find(this.node,'span.sectionLabel');if(eb.getAttribute('data-original-label')){i.setContent(eb,eb.getAttribute('data-original-label'));eb.removeAttribute('data-original-label');}},unload:function(){if(!this.loaded||!this.canUnload)return;this.loaded=false;na[this.scrubberKey]&&na[this.scrubberKey].cancel();h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&h.hasClass(this.node.nextSibling,'fbTimelineSection')){i.setContent(this.node,this.node.nextSibling);h.show(this.node.firstChild);}else i.empty(this.node);this.deactivateScrollLoad();},activateScrollLoad:function(){this.canScrollLoad=true;h.removeClass(this.node,'fbTimelineTimePeriodSuppressed');h.addClass(this.node,'fbTimelineTimePeriodUnexpanded');ma[this.scrubberKey]&&ma[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this.canScrollLoad=false;h.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');h.addClass(this.node,'fbTimelineTimePeriodSuppressed');ma[this.scrubberKey]&&ma[this.scrubberKey].remove();}},setExpandLoadData:function(eb){this._expandPageletLoadData=eb;return this;},expandSubSections:function(){if(this.subSections.length)db.navigateToSection(this.subSections[0].scrubberKey);},expand:function(eb){if(!this.loaded)return;qa.add_event('expand_'+this.scrubberKey);var fb=i.find(this.node,'.fbTimelineSectionExpander');h.addClass(fb.firstChild,'async_saving');eb&&h.addClass(eb,'async_saving');this._expandPageletLoadData.time_cutoff=db.getTimeCutoff();db.navigateToSection(this.scrubberKey);i.scry(this.node,'ol.fbTimelineCapsule').forEach(i.remove);this._expandPageletLoadData.new_expand=true;na[this.scrubberKey]&&na[this.scrubberKey].cancel();na[this.scrubberKey]=s.loadFromEndpoint('ProfileTimelineSectionPagelet',fb.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true});},isPermalinkPeriod:function(){return this._pageletLoadData.is_permalink_period;}});function ua(){if(da)return;n.register(n.CONTENT,db);qa=ca('scrubber').set_namespace('timeline').set_ua_id('scrubber');da=true;if(t.ie()<=7)ea=true;}var va=y(function(eb,fb,gb){var hb=db.getSection(eb).historicUnitCount;fb-=hb;gb-=1;if(hb==-1||gb<=0||fb<0)return;var ib=db.getNextSectionKey(eb);if(ib){db.getSection(ib).load();va(ib,fb,gb);}},500),wa={};function xa(eb,fb){oa=q.getInstance('displayPagelet');oa.throttle(function(){var gb=u.getViewportDimensions().y,hb=u.getScrollPosition().y,ib=hb+gb,jb=hb+gb*(oa.config.fociRatio||.5),kb=u.getElementPosition(eb).y;if(kb>jb)if(kb<ib){wa[eb.id]=(wa[eb.id]||0)+1;if(wa[eb.id]<(oa.config.fociPenalty||3))return q.REQUEUE;}else{delete wa[eb.id];return q.REQUEUE;}delete wa[eb.id];fb();});}function ya(eb,fb,gb){var hb=db.getNextSectionKey(fb);if(hb)ma[hb]=new k(eb,za.curry(hb),false,gb||1000);}function za(eb){if(ga[eb].canScrollLoad){qa.add_event("scroll_load_"+eb);if(ea){db.getSection(eb).preload();}else{db.getSection(eb).load();if(sa)va(eb,sa.required_units,sa.max_parallelism);}}}function ab(){var eb,fb,gb=false;for(var hb=0;hb<ja.length;hb++){var ib=ja[hb];if(!ib)continue;var jb=db.getSection(ib);if(jb.canScrollLoad||jb.loaded){if(!jb.loaded){h.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');h.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}if(eb&&fb){bb(eb,fb);if(gb)eb.deactivateScrollLoad();gb=true;}eb=null;fb=null;continue;}else if(eb){fb=jb;jb.deactivateScrollLoad();}else{eb=jb;if(gb)jb.activateScrollLoad();}h.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');h.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}}function bb(eb,fb){h.removeClass(fb.node,'fbTimelineTimePeriodUnexpanded');h.addClass(fb.node,'fbTimelineTimePeriodSuppressed');var gb=i.find(eb.node,'span.sectionLabel'),hb=i.find(fb.node,'span.sectionLabel');if(!hb.getAttribute('data-original-label'))hb.setAttribute('data-original-label',i.getText(hb));if(gb.getAttribute('data-month')&&hb.getAttribute('data-month')&&gb.getAttribute('data-year')==hb.getAttribute('data-year')){i.setContent(hb,ba._("Show {month1} - {month2} {year}",{month1:hb.getAttribute('data-month'),month2:gb.getAttribute('data-month'),year:gb.getAttribute('data-year')}));}else if(gb.getAttribute('data-year')!==hb.getAttribute('data-year')){i.setContent(hb,ba._("Show {year1} - {year2}",{year1:hb.getAttribute('data-year'),year2:gb.getAttribute('data-year')}));}else i.setContent(hb,ba._("Show {year}",{year:hb.getAttribute('data-year')}));}function cb(eb){if(ea)for(var fb=0;fb<ja.length-1;fb++){var gb=ja[fb];if(!gb)continue;if(gb!=eb){var hb=ga[gb];if(hb.loaded&&hb.canUnload)hb.unload();}}ab();}var db={WAY_BACK:'way_back',RECENT:'recent',HEADER_SCROLL_CUTOFF:80,CURRENT_SECTION_OFFSET:150,registerTimePeriod:function(eb,fb,gb,hb,ib,jb,kb,lb){ua();if(ka.contains(fb))return;var mb=new ta(eb,fb,gb,hb,kb);if(!ib){ja[jb]=fb;ia[fb]=true;}else{mb.parentKey=ib;ga[ib].subSections=ga[ib].subSections||[];ga[ib].subSections[jb]=mb;}ga[fb]=mb;if(lb)db.checkCurrentSectionChange();g.inform(n.SECTION_REGISTERED,{scrubberKey:fb});n.registerSectionKey(fb,jb);},reset:function(){for(var eb in ma)ma[eb].remove();for(var fb in na)na[fb].cancel();fa&&fa.unsubscribe();fa=null;oa&&oa.cancel();oa=null;ga={};ha=null;ia={};ja=[];ka=[];la={};ma={};na={};pa=null;qa=null;ra=false;da=false;},checkCurrentSectionChange:function(){var eb=db.getCurrentSection(),fb=ha&&ha.scrubberKey;if(eb&&eb.scrubberKey!==fb&&!eb.isPermalinkPeriod()){ha=eb;var gb=eb.scrubberKey,hb=eb.parentKey;if(!hb){hb=gb;gb=null;}n.sectionHasChanged(hb,gb);}},setTimeCutoff:function(eb){pa=eb;},getTimeCutoff:function(){return pa;},setParallelLoadConfig:function(eb){sa=eb;},getCurrentSection:function(){var eb={};for(var fb in ga){var gb=ga[fb];if(!gb.loaded||la[gb.scrubberKey])continue;var hb=u.getElementPosition(gb.node,'viewport').y;if(gb.scrubberKey=='recent')hb--;if(hb<db.CURRENT_SECTION_OFFSET)eb[hb]=gb;}var ib=Math.max.apply(null,Object.keys(eb)),jb=ib==-Infinity;if(!jb){return eb[ib];}else if(ja[0])return ga[ja[0]];return null;},capsuleForCurrentSection:function(){var eb=db.getCurrentSection();return eb&&i.scry(eb.node,'ol.fbTimelineCapsule')[0];},enableScrollLoad:function(eb,fb,gb){var hb=i.scry(eb.parentNode,'ol.fbTimelineCapsule')[0];if(!hb)return;ya(eb,fb,gb);},getSection:function(eb){return ga[eb];},getNextSectionKey:function(eb){for(var fb=0;fb<ja.length-1;fb++)if(ja[fb]==eb){while(fb<ja.length-1&&!ja[fb+1])fb++;return ja[fb+1];}var gb=db.getSection(eb);if(!gb||!gb.parentKey)return;var hb=db.getSection(gb.parentKey);if(!hb)return;for(var ib=0;ib<hb.subSections.length-1;ib++)if(hb.subSections[ib].scrubberKey==eb)return hb.subSections[ib+1].scrubberKey;},hideSection:function(eb){var fb=db.getSection(eb);fb&&h.hide(fb.node);var gb=n.getCurrentScrubber();if(gb){var hb=n.getCurrentScrubber().getNav(eb);hb&&h.hide(hb);}var ib=n.getCurrentStickyHeaderNav();ib&&ib.removeTimePeriod(eb);la[eb]=true;},removeSection:function(eb){for(var fb in ja)if(ja[fb]==eb){ja[fb]=null;break;}delete ga[eb];delete ia[eb];if(eb in ma){ma[eb].remove();delete ma[eb];}var gb=n.getCurrentStickyHeaderNav();gb&&gb.removeTimePeriod(eb);ka.push(eb);},navigateToSection:function(eb,fb,gb){qa.add_event("nav_"+eb);fb=!!fb;var hb=eb,ib=db.getSection(eb);if(!ib)return;if(!ib.loaded)p.enable();if(!ia[eb]){ib.node.style.minHeight=u.getViewportDimensions().y+'px';var jb=g.subscribe(n.SECTION_FULLY_LOADED,function(qb,rb){if(rb.scrubberKey===eb){ib.node.style.minHeight='';jb.unsubscribe();}});hb=ib.parentKey;var kb=db.getSection(hb).node;if(!h.hasClass(kb,'fbTimelineSectionExpanded')){j.scrollTo(kb,0);h.addClass(kb,'fbTimelineSectionExpanded');i.scry(kb,'ol.fbTimelineCapsule').forEach(i.remove);i.scry(kb,'div.fbTimelineSectionExpandPager').forEach(i.remove);i.scry(kb,'div.fbTimelineContentHeader').forEach(i.remove);}}for(var lb=0;lb<ja.length;lb++){var mb=ja[lb];if(!mb)continue;if(mb==hb)break;db.getSection(mb).deactivateScrollLoad();i.scry(v('timeline_tab_content'),'.fbTimelineSectionExpandPager').forEach(function(qb){var rb=l.getInstance(qb.id);rb&&rb.removeOnVisible();});}db.adjustContentPadding();ib.load(gb);ab();var nb=u.getScrollPosition().x,ob=u.getElementPosition(ib.node).y;if(!fb){var pb=ia[eb]?m.SCROLL_TO_OFFSET:m.SUBSECTION_SCROLL_TO_OFFSET;j.scrollTo(new u(nb,ob-pb,'document'),true,false,false,function(){var qb=u.getElementPosition(ib.node).y;j.scrollTo(new u(nb,qb-pb,'document'),false);var rb=i.scry(ib.node,'h3.uiHeaderTitle')[0];rb&&rb.focus();});}},adjustContentPadding:function(){var eb=z('timeline_tab_content');if(!eb)return;var fb=n.getCurrentKey()||r.TIMELINE_KEY;if(fb!==r.TIMELINE_KEY)return;var gb=db.getSection(db.WAY_BACK);eb.style.paddingBottom=gb&&gb.loaded?null:u.getViewportDimensions().y-db.CURRENT_SECTION_OFFSET-db.HEADER_SCROLL_CUTOFF+'px';},suppressSectionsAbove:function(eb){var fb,gb;for(var hb=0;hb<ja.length;hb++){var ib=ja[hb];if(!ib)continue;fb=db.getSection(ib).node;gb=null;if(x(eb.parentNode.children).indexOf(eb)<=x(fb.parentNode.children).indexOf(fb)){gb=ib;break;}db.getSection(ib).deactivateScrollLoad();}if(gb)db.navigateToSection(gb,true);},forceNoFriendActivity:function(){ra=true;},removeDupes:function(eb){var fb=z(eb);if(!fb)return;var gb=i.scry(fb,'li.fbTimelineUnit'),hb={};for(var ib=0;ib<gb.length;ib++){var jb=gb[ib];if(jb.id&&aa(jb.id,'tl_unit_')){var kb=jb.id.substring(8,jb.id.length),lb=(jb.getAttribute('data-unit')=='ExperienceSummaryUnit'?jb.getAttribute('data-time'):1);if(hb.hasOwnProperty(kb)&&hb[kb]==lb){i.remove(jb);}else hb[kb]=lb;}}}};e.exports=a.TimelineContentLoader||db;});
__d("TimelineCapsule",["$","Arbiter","createArrayFrom","CSS","DataStore","DOM","DOMScroll","ge","Hovercard","Parent","TimelineConstants","TimelineContentLoader","TimelineController","TimelineSmartInsert","TimelineThrottler","UserAgent","Util","Vector","isEmpty"],function(a,b,c,d,e,f){var g=b('$'),h=b('Arbiter'),i=b('createArrayFrom'),j=b('CSS'),k=b('DataStore'),l=b('DOM'),m=b('DOMScroll'),n=b('ge'),o=b('Hovercard'),p=b('Parent'),q=b('TimelineConstants'),r=b('TimelineContentLoader'),s=b('TimelineController'),t=b('TimelineSmartInsert'),u=b('TimelineThrottler'),v=b('UserAgent'),w=b('Util'),x=b('Vector'),y=b('isEmpty'),z=(function(){var aa=45,ba=15,ca={},da={},ea={},fa={};function ga(ya){return j.hasClass(ya,'fbTimelineBalancer');}function ha(ya){return ya.getAttribute('data-spine');}function ia(ya){return j.hasClass(ya,'placeholderUnit');}function ja(ya){return ya.getAttribute('data-fixed');}function ka(ya,za){if(za)return (k.get(q.DS_SIDEORG,ya.id)||ya.getAttribute('data-side'));return ya.getAttribute('data-side');}var la=function(ya,za){if(v.ie()<=6){la=function(ab,bb){k.set(q.DS_SIDEORG,ab.id,ka(ab,true));ab.setAttribute('data-side',bb);j.removeClass(ab,'leftColumn');j.removeClass(ab,'rightColumn');j.addClass(ab,bb=='l'?'leftColumn':'rightColumn');};}else la=function(ab,bb){k.set(q.DS_SIDEORG,ab.id,ka(ab,true));ab.setAttribute('data-side',bb);};la(ya,za);};function ma(ya){return ya.getAttribute('data-size');}var na=function(ya,za){if(ga(ya))return;if(za){j.addClass(ya,'balancingCapsule');}else j.removeClass(ya,'balancingCapsule');};function oa(ya){if(j.hasClass(ya,'fbTimelineIndeterminateContent'))return 0;return ba;}function pa(ya){var za=0;if(j.shown(ya)&&!j.hasClass(ya,'placeholderUnit'))za=ya.offsetHeight+oa(ya);k.set(q.DS_HEIGHT,ya.id,za);}function qa(ya){var za=k.get(q.DS_HEIGHT,ya.id,null);return za;}function ra(ya,za){if(ma(za)=='2'){return 0;}else if(ka(za)=='r'){return ya+qa(za);}else return ya-qa(za);}function sa(ya){var za=ya.parentNode;if(!za)return;var ab=document.createDocumentFragment(),bb=ya.firstChild;while(bb.firstChild)ab.appendChild(bb.firstChild);t.run(za,l.replace.curry(ya,ab));h.inform('TimelineCapsule/balanced',{capsule:za});}function ta(ya){for(var za=0;za<ya.children.length;za++){var ab=ya.children[za];if(!ab.getAttribute('data-endmarker'))continue;var bb=ab.getAttribute('data-endmarker'),cb=ab.getAttribute('data-pageindex'),db=function(){k.set(q.DS_LOADED,ya.id,cb);l.remove(ab);h.inform(s.SECTION_FULLY_LOADED,{scrubberKey:bb,pageIndex:cb,capsuleID:ya.id,childCount:ya.children.length});};if(r.getSection(bb)){db();}else var eb=h.subscribe(s.SECTION_REGISTERED,function(fb,gb){if(gb.scrubberKey===bb){db();eb.unsubscribe();}});break;}}function ua(ya,za,ab){while(za[0])la(za.pop(),'l');while(ab[0])la(ab.pop(),'r');if(ga(ya))sa(ya);ta(ya);}function va(ya){var za=ga(ya)?ya.firstChild:ya,ab=za.childNodes.length,bb=[],cb;if(ca[ya.id]){if(y(ca[ya.id]))return;var db={},eb,fb,gb,hb;for(eb=0;eb<ab;eb++){fb=za.childNodes[eb];if(!ha(fb))db[fb.id]=fb.offsetTop;}for(eb=0;eb<ab;++eb){fb=za.childNodes[eb];if(ha(fb)){continue;}else if(ca[ya.id][fb.id]){bb.push(fb);continue;}else if(cb&&bb.length&&ma(cb)!='2'){gb=db[cb.id]+aa;hb=db[fb.id];if(ma(fb)=='2')hb-=aa;var ib;while(gb<=hb){ib=bb.shift();if(!ib)break;j.show(ib);ib.style.top=gb+"px";gb+=aa;}while(bb[0])j.hide(bb.pop());}cb=fb;}while(bb[0])j.hide(bb.pop());}na(ya,false);}function wa(ya,za){var ab=p.byAttribute(ya,'data-size');if(ab){if(j.hasClass(ya.parentNode,'timelineReportContent')){za(ya);}else za(ab);z.balanceCapsule(p.byClass(ab,'fbTimelineCapsule'));}}function xa(ya){var za=0;for(var ab=0;ab<ya.childNodes.length;ab++)if(j.hasClass(ya.childNodes[ab],'fbTimelineUnit'))za++;return za;}return {getUnitsWithTime:function(ya){return l.scry(ya,'.timelineUnitContainer').filter(function(za){return (za.parentNode.parentNode===ya&&za.getAttribute('data-time'));});},removeUnit:function(ya){wa(ya,function(za){l.remove(za);});},hideUnit:function(ya){wa(ya,function(za){j.addClass(za,'fbTimelineColumnHidden');});},undoHideUnit:function(ya,za){l.remove(p.byClass(za,'hiddenText'));wa(ya,function(ab){j.removeClass(ab,'fbTimelineColumnHidden');});},unplacehold:function(ya){var za=g(ya);za.style.top=null;j.removeClass(za,'visiblePlaceholder');j.removeClass(za,'placeholder');var ab=p.byClass(za,'fbTimelineCapsule');delete ca[ab.id][ya];z.balanceCapsule(ab);},scrollToCapsule:function(ya){if(!fa.hasOwnProperty(ya.id)){var za=x.getElementPosition(ya.parentNode);m.scrollTo(new x(x.getScrollPosition().x,za.y-q.SUBSECTION_SCROLL_TO_OFFSET,'document'));fa[ya.id]=true;}},setFirstUnit:function(ya){var za=true,ab=ya.childNodes.length;for(var bb=0;bb<ab;bb++){var cb=ya.childNodes[bb];if(cb.id.indexOf('tl_unit_')===0)if(za){za=false;j.addClass(cb,'firstUnit');}else{j.removeClass(cb,'firstUnit');break;}}},balanceCapsule:function(ya,za){if(!ya)return;if(ya.getAttribute('data-layout')=='fixed'){u.getInstance('balanceCapsuleFixed').debounce(z.balanceFixed.curry(ya,za),ya.id);}else u.getInstance('balanceCapsule').throttle(z.balance.curry(ya,0),ya.id);},balanceFixed:function(ya,za){if(!ya)return;if(v.chrome()||v.safari())j.toggleClass(ya,'webkitFix');var ab=0,bb,cb=document.createDocumentFragment(),db=[],eb=[],fb=[],gb=false;for(var hb=0;hb<ya.childNodes.length;hb++){bb=ya.childNodes[hb];if(ha(bb)){continue;}else if(ga(bb)){i(bb.firstChild.childNodes).forEach(pa);continue;}pa(bb);if(ka(bb,true)=='r'){eb.push(bb);}else db.push(bb);fb.push(bb);if(ma(bb)!='2')if((ab>0&&ka(bb)=='r')||(ab<0&&ka(bb)=='l'))gb=true;ab=ra(ab,bb);}var ib=[],jb=[],kb=[];l.scry(ya,'li.fbTimelineBalancer').forEach(function(nb){var ob=i(nb.firstChild.childNodes);if(nb.getAttribute('data-nonunits')){kb=kb.concat(ob);}else if(ka(nb)=='left'){ib=ib.concat(ob);}else if(ka(nb)=='right')jb=jb.concat(ob);});if(gb){ya.style.minHeight=ya.offsetHeight;db.forEach(function(nb){if(ma(nb)!='2')la(nb,'l');});eb.forEach(function(nb){if(ma(nb)!='2')la(nb,'r');});var lb=l.create('li',{className:'fbTimelineBalancer'},l.create('ol',null,db));lb.setAttribute('data-side','left');l.prependContent(ya,lb);ib=db.concat(ib);var mb=l.create('li',{className:'fbTimelineBalancer'},l.create('ol',null,eb));mb.setAttribute('data-side','right');l.prependContent(ya,mb);jb=eb.concat(jb);ab=0;}while((ab>=0&&ib.length)||(ab<0&&jb.length)){if(ab>=0){bb=ib.shift();}else bb=jb.shift();cb.appendChild(bb);ab=ra(ab,bb);}while(kb.length)cb.appendChild(kb.shift());ya.appendChild(cb);l.scry(ya,'li.fbTimelineBalancer').forEach(function(nb){if(!nb.firstChild.childNodes.length)l.remove(nb);});if(za&&za.tail_balance){ab=z.tailBalance(ya,ab,za.tail_balance);}else if(k.get(q.DS_TAILBALANCE,ya.id))ab=z.tailBalance(ya,ab,q.FIXED_SIDE_BOTH);if(gb){fb.forEach(function(nb){if(nb.parentNode!==ya){ya.appendChild(nb);ab=ra(ab,nb);}});ya.style.minHeight=null;}k.set(q.DS_COLUMN_HEIGHT_DIFFERENTIAL,p.byClass(ya,'fbTimelineSection').id,ab);ca[ya.id]={};l.scry(ya,'li.placeholderUnit').forEach(function(nb){ca[ya.id][nb.id]=nb;});va(ya);ta(ya);h.inform('TimelineCapsule/balanced',{capsule:ya});},tailBalance:function(ya,za,ab){if(!ya)return za;var bb=[],cb=[],db=[],eb=[];l.scry(ya,'li.fbTimelineBalancer').forEach(function(gb){var hb=i(gb.firstChild.childNodes);if(gb.getAttribute('data-nonunits')){eb=eb.concat(hb);}else if(ka(gb)=='left'){cb=cb.concat(hb);}else if(ka(gb)=='right')db=db.concat(hb);bb=bb.concat(hb);});if((ab==q.FIXED_SIDE_RIGHT&&cb.length)||(ab==q.FIXED_SIDE_LEFT&&db.length))return za;var fb=document.createDocumentFragment();if(bb)while(bb.length){if(ma(bb[0])!='2')if(za>=0){la(bb[0],'l');}else la(bb[0],'r');za=ra(za,bb[0]);fb.appendChild(bb.shift());}ya.appendChild(fb);l.scry(ya,'li.fbTimelineBalancer').forEach(function(gb){if(!gb.firstChild.childNodes.length)l.remove(gb);});k.set(q.DS_TAILBALANCE,ya.id,true);return za;},balance:function(ya,za,ab){if(!ya)return;if(!ca[ya.id])ca[ya.id]={};var bb=ga(ya)?ya.firstChild:ya,cb=bb.childNodes.length,db=[],eb=[];if(v.chrome()||v.safari())j.toggleClass(ya,'webkitFix');for(var fb=0;fb<cb;fb++)pa(bb.childNodes[fb]);var gb=false;for(fb=0;fb<cb;fb++){var hb=bb.childNodes[fb];if(ha(hb))continue;var ib=(za>=0),jb=hb.nextSibling;if(ja(hb)){if(ka(hb)=='r'){if(za>0)if(jb&&ma(jb)!='2'){var kb=[hb];while(jb&&ja(jb)&&ka(jb)=='r'){kb.push(jb);jb=jb.nextSibling;}if(jb){if(ga(jb)){var lb=jb.firstChild;l.prependContent(lb,kb);pa(lb);cb-=kb.length;}else l.insertBefore(hb,jb);fb--;}continue;}za+=qa(hb);}else za-=qa(hb);}else if(hb.id&&(ca[ya.id][hb.id]||ia(hb))){ca[ya.id][hb.id]=hb;continue;}else if(ga(hb)){za=z.balance(hb,za);}else if(ma(hb)=='2'){if(jb&&ja(jb)&&ka(jb)=='r'&&za<=0){l.insertBefore(hb,jb);fb--;}else{ib=true;za=0;}}else if(ib){db.push(hb);za-=qa(hb);}else{var mb=false;if(!gb){while(jb&&(!ja(jb)||ka(jb)!='r'))jb=jb.nextSibling;if(jb){l.insertBefore(hb,jb);fb--;mb=true;}else gb=true;}if(!mb){eb.push(hb);za+=qa(hb);}}}na(ya,true);if(ab&&ab.nothrottle){ua(ya,db,eb);va(ya);}else{clearTimeout(ea[ya.id]);ea[ya.id]=setTimeout(function(){u.getInstance('positionUnits').debounce(ua.curry(ya,db,eb),ya.id);delete ea[ya.id];},50);clearTimeout(da[ya.id]);da[ya.id]=setTimeout(function(){u.getInstance('adjustPlaceholders').debounce(va.curry(ya),ya.id);delete da[ya.id];},150);}return za;}};})();e.exports=a.TimelineCapsule||z;});
__d("legacy:TimelineCapsule",["TimelineCapsule"],function(a,b,c,d){a.TimelineCapsule=b('TimelineCapsule');},3);
var TimelineComposerUtilities=(function(){var a=86400*31,b=86400000;return {listenToSetEstimatedDate:function(c,d){return Arbiter.subscribe('TimelineBackdatedComposerTagger/initialized',function(event,e){if(e.composer===c)Bootloader.loadComponents('TimelineContentLoader',function(){e.date_picker.subscribe('initialized',function(f,g){TimelineComposerUtilities.setEstimatedDate(g,d());});});});},listenToPublish:function(c,d){return Arbiter.subscribe('composer/publish',function(event,e){if(e.composer===c)Bootloader.loadComponents('TimelineStoryPublisher',function(){TimelineStoryPublisher.publish(e);d&&d();});});},listenToAnotherComposerOpen:function(c,d){return Arbiter.subscribe('composer/mutate',function(e,f){if(f!==c)d();});},listenToCancel:function(c,d){return Event.listen(c,'click',function(event){Parent.byClass(event.getTarget(),'cancelBtn')&&d();});},hidePlaceIfAttachmentsTooTall:function(c){var d=DOM.find(c,'ul.fbTimelineComposerAttachments'),e=Vector2.getElementDimensions(d).y;if(e>50){var f=Parent.byTag(DOM.scry(d,'span.placeAttachment')[0],'li');f&&CSS.hide(f);}},setEstimatedDate:function(c,d){var e,f;if(d&&CSS.hasClass(d,'fbTimelineCapsule')){e=d.getAttribute('data-start');f=d.getAttribute('data-end');if(e&&f){var g=new Date(f*1000);if(f-e>2*a){c.setDate(g.getFullYear());}else c.setDate(g.getFullYear(),g.getMonth()+1);}return;}var h=Parent.byClass(d,'fbTimelineCapsule');if(h){e=h.getAttribute('data-start');f=h.getAttribute('data-end');var i=Vector2.getElementPosition(d).y,j=[f,null],k=[e,null],l=TimelineCapsule.getUnitsWithTime(h);for(var m=0;m<l.length;m++){var n=l[m],o=DOM.scry(n.parentNode,'.spinePointer')[0];if(!o)continue;var p=Vector2.getElementPosition(o).y;if(p<=i){if(!j[1]||p>j[1])j=[n.getAttribute('data-time'),p];}else if(!k[1]||p<k[1])k=[n.getAttribute('data-time'),p];}if(j[0]!==null&&k[0]!==null){var q=Math.round((parseInt(j[0],10)+parseInt(k[0],10))/2)*1000;q=Math.min(new Date()-b,q);c.setDateWithTimestamp(q);}}}};})();
var TimelineBackdatedComposer=(function(){var a;function b(){c();d();}function c(){a.hide();}function d(){Bootloader.loadComponents('TimelineMLE',function(){var e=TimelineMLE.getFlyout();if(e&&CSS.hasClass(e.getContext(),'backdatedDot'))TimelineMLE.hideFlyout();});}return {init:function(e,f){a=f;var g=[TimelineComposerUtilities.listenToPublish(e,b),TimelineComposerUtilities.listenToAnotherComposerOpen(e,b),TimelineComposerUtilities.listenToSetEstimatedDate(e,a.getContext.bind(a)),e.subscribeToMutate(function(){var i=!DOM.scry(e.root,'.cancelBtn')[0]||DOM.scry(e.root,'.attachmentLifeEvents')[0];if(i){a.enableBehavior(LayerHideOnBlur);}else a.disableBehavior(LayerHideOnBlur);}),Arbiter.subscribe('TimelineMLE/mleFlyoutShown',function(i,j){if(CSS.hasClass(j.getContext(),'backdatedDot')){c();}else b();}),Arbiter.subscribe(TimelineNavigation.UPDATE_PAGE,b)],h=TimelineComposerUtilities.listenToCancel(a.getContent(),b);onleaveRegister(function(){g.forEach(Arbiter.unsubscribe.bind(Arbiter));g=[];h.remove();h=null;});Arbiter.inform('TimelineBackdatedComposer/initialized');},getFlyout:function(){return a;}};})();
var TimelineComposer=(function(){var a;function b(f){if(f.isScheduledPost)return;if(!f.streamStory){window.location.reload();return;}if(f.backdatedTime){Bootloader.loadComponents('TimelineStoryPublisher',function(){TimelineStoryPublisher.publish(f);});return;}var g=Parent.byClass(a,'fbTimelineCapsule');if(!g)return;var h=Parent.byClass(a,'timelineUnitContainer').parentNode;if(h.nextSibling.getAttribute('data-spine'))h=h.nextSibling;unit_node=DOM.insertAfter(h,f.streamStory)[0];Bootloader.loadComponents('animation',function(){animation(unit_node.firstChild).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(animation.ease.both).go();});TimelineCapsule.setFirstUnit(g);TimelineCapsule.balanceCapsule(g);}function c(){var f=Parent.byClass(a,'fbTimelineTwoColumn');return DOM.find(f,'.spinePointer');}function d(f){var g=e();CSS.show(g);var h=f.subscribe('hide',function(){CSS.hide(g);f.unsubscribe(h);});}function e(){var f=Parent.byClass(a,'fbTimelineTwoColumn'),g=DOM.scry(f,'div.composerVeil');if(g.length!==1)g=DOM.appendContent(f,$N('div',{className:'composerVeil hidden_elem'}));return g[0];}return {init:function(f){a=$(f);var g=Arbiter.subscribe('composer/publish',function(event,h){if(h.composer.root===a)b(h);});onleaveRegister(function(){g.unsubscribe();});TimelineComposerUtilities.hidePlaceIfAttachmentsTooTall(a);},showMLEFlyout:function(f){f.setContext(c()).show();d(f);}};})();
__d("legacy:TimelineContentLoader",["TimelineContentLoader"],function(a,b,c,d){a.TimelineContentLoader=b('TimelineContentLoader');},3);
function TimelineCoverDisclaimer(a,b,c){if(TimelineCoverDisclaimer.displayed===undefined){TimelineCoverDisclaimer.displayed=true;}else return;new Dialog().setModal(true).setTitle(a).setBody(b).setButtonsMessage(c).setButtons(Dialog.OK).show();}
requireLazy(['Selector'],function(a){add_properties('__behaviors',{});if(__behaviors.TimelineCurationControl)return;__behaviors.TimelineCurationControl=true;a.subscribe('open',function(b,c){var d=c.selector,e=c.clone||d,f=Parent.byClass(e,'fbTimelineCurationControl');if(f){CSS.addClass(f,'editControlsMenuOpen');var g=a.subscribe('close',function(h,i){if(i.selector==d){a.unsubscribe(g);CSS.removeClass.curry(f,'editControlsMenuOpen').defer();}});}});});
__d("legacy:TimelinePerfConfig",["TimelinePerfConfig"],function(a,b,c,d){a.TimelinePerfConfig=b('TimelinePerfConfig');},3);
function TimelineSpine(){}copy_properties(TimelineSpine,{OFFSET_Y:12,composerFlyout:null,mleFlyout:null,dot:null,loadComposerFlyoutCalled:false,showComposerFlyout:function(a){var b=TimelineSpine.composerFlyout;if(!b){TimelineSpine.loadComposerFlyout(a);TimelineSpine.showComposerFlyoutOnLoad=true;return;}var c=DOM.find(b.getContent(),'div.fbTimelineBackdatedComposer'),d=Composer.getInstance(c);if(d){d.reset();CSS.removeClass(d.root,'uiComposerOpen');}b.enableBehavior(LayerHideOnBlur).setContext(TimelineSpine.dot).updatePosition();b.show();TimelineComposerUtilities.hidePlaceIfAttachmentsTooTall(c);},loadComposerFlyout:function(a){if(TimelineSpine.loadComposerFlyoutCalled||TimelineSpine.composerFlyout)return;TimelineSpine.loadComposerFlyoutCalled=true;onleaveRegister(function(){TimelineSpine.loadComposerFlyoutCalled=false;TimelineSpine.composerFlyout=null;}.bind(this));new AsyncRequest().setURI('/ajax/timeline/backdated_composer.php').setData({targetid:a}).setRelativeTo(TimelineSpine.dot||document.body).send();var b=Arbiter.subscribe('TimelineBackdatedComposer/initialized',function(){TimelineSpine.composerFlyout=TimelineBackdatedComposer.getFlyout();if(TimelineSpine.showComposerFlyoutOnLoad)TimelineSpine.showComposerFlyout(a);TimelineSpine._handleComposerFlyoutDismissed();b.unsubscribe();});},showMLEFlyout:function(a){TimelineSpine.mleFlyout=a;a.setContext(TimelineSpine.dot).show();TimelineSpine.composerFlyout.hide();},_handleComposerFlyoutDismissed:function(){var a=Layer.subscribe('hide',function(b,c){if(TimelineSpine.dot&&c.getContext)if(c.getContext()===TimelineSpine.dot&&!TimelineSpine.mleFlyout){TimelineSpine._hideDot();}else if(c===TimelineSpine.mleFlyout){TimelineSpine.mleFlyout=null;TimelineSpine._hideDot();}});onleaveRegister(function(){Layer.unsubscribe(a);}.bind(this));},_hideDot:function(){DOM.remove(TimelineSpine.dot);TimelineSpine.dot=null;}});copy_properties(TimelineSpine.prototype,{init:function(a,b){this._spine=a;if(!TimelinePerfConfig.getDisableSpineHeight())this._spineHeight=a.offsetHeight;this._plus=DOM.find(a,'.spineHoverPlus');this._capsule=Parent.byClass(a,'fbTimelineCapsule');this._targetid=b;var c=[Event.listen(a,'mouseenter',function(event){TimelineSpine.loadComposerFlyout(this._targetid);this._spineHeight=a.offsetHeight;}.bind(this)),Event.listen(a,'mousemove',this._mouseMoved.bind(this)),Event.listen(a,'click',this._spineClicked.bind(this))];CSS.addClass(this._plus,'spineHoverPlusActive');onleaveRegister(function(){while(c.length)c.pop().remove();}.bind(this));},_mouseMoved:function(event){var a=event.offsetY||event.layerY,b=event.getTarget();if(b!==this._spine)a=b.offsetTop+a;a=Math.min(Math.max(a-TimelineSpine.OFFSET_Y,0),this._spineHeight);this._plus.style.top=a+'px';},_spineClicked:function(event){if(TimelineSpine.mleFlyout){Bootloader.loadComponents('TimelineMLE',TimelineMLE.hideFlyout);return;}TimelineSpine.dot&&DOM.remove(TimelineSpine.dot);TimelineSpine.dot=$N('i',{className:'backdatedDot'});TimelineSpine.dot.style.top=(this._plus.offsetTop-1)+'px';DOM.appendContent(this._spine,TimelineSpine.dot);event.stop();TimelineSpine.showComposerFlyout(this._targetid);}});
function TimelineScrubber(a){this._root=a;this._navKeys={};this._subNavKeys={};this._rollups={};this._rolledup={};var b=a.childNodes;this._currentNav=b[0];for(var c=0;c<b.length;c++){var d=b[c].getAttribute('data-key');this._navKeys[d]=b[c];var e=DOM.scry(b[c],'ul');this._subNavKeys[d]={};if(e.length){var f=e[0].childNodes;for(var g=0;g<f.length;g++)this._subNavKeys[d][f[g].getAttribute('data-key')]=f[g];}var h=b[c].getAttribute('data-rollup');if(h){this._rollups[h]=this._rollups[h]||[];this._rollups[h].push(b[c]);}}this._clickListener=Event.listen(this._root,'click',this._handleScrub.bind(this));CSS.show(this._root);var i=Vector2.getViewportDimensions().y-this.SCRUBBER_NO_ADS_VERTICAL_BUFFER,j=this.getHeight();if(j>i)this.fold(j-i);TimelineController.register(TimelineController.SCRUBBER,this);TimelineController.scrubberHasLoaded(this);}copy_properties(TimelineScrubber.prototype,{KEY_HEIGHT:23,SUBKEY_HEIGHT:16,OFFSET:38,SCRUBBER_NO_ADS_VERTICAL_BUFFER:125,reset:function(){this._root=null;this._navKeys={};this._subNavKeys={};this._rollups={};this._rolledup={};},getRoot:function(){return this._root;},getNav:function(a){return this._navKeys[a];},getSubnav:function(a,b){return this._subNavKeys[a][b];},getHeight:function(){return this._root.offsetHeight;},getLabelForNav:function(a){var b=this.getNav(a);return b&&DOM.getText(DOM.scry(b,'a')[0]);},getLabelForSubnav:function(a,b){var c=this.getSubnav(a,b);return c&&DOM.getText(DOM.scry(c,'a')[0]);},fold:function(a){return this._adjustFolding(a,true);},unfold:function(a){return this._adjustFolding(a,false);},getOffset:function(){return this.OFFSET;},updateSection:function(a,b){var c=this._navKeys[a].getAttribute('data-rollup');if(this._currentRollup&&this._currentRollup!=c){CSS.removeClass(this._currentRollup,'selected');CSS.removeClass(DOM.scry(this._currentRollup,'ul')[0],'loaded');delete this._currentRollup;}if(c&&this._rolledup[c]){var d=this._rolledup[c];if(d.getAttribute('data-rollup')){this._currentRollup=d;CSS.addClass(this._currentRollup,'selected');CSS.addClass(DOM.scry(this._currentRollup,'ul')[0],'loaded');}}this._currentNav&&CSS.removeClass(this._currentNav,'selected');this._currentSubNav&&CSS.removeClass(this._currentSubNav,'selected');this._currentNav=null;this._currentSubNav=null;if(this._navKeys[a]){this._currentNav=this._navKeys[a];CSS.addClass(this._currentNav,'selected');if(this.decadesAreSelectable&&this._navKeys[b]){this._currentSubNav=this._navKeys[b];CSS.addClass(this._currentSubNav,'selected');}else if(b&&this._subNavKeys[a][b]){this._currentSubNav=this._subNavKeys[a][b];CSS.addClass(this._currentSubNav,'selected');}}},_getRollupSize:function(a){var b=this._currentNav,c=b&&b.getAttribute('data-rollup'),d=this.KEY_HEIGHT*(this._rollups[a].length-1);if(a==c){d+=this.SUBKEY_HEIGHT*DOM.scry(b,'li').length;d-=this.SUBKEY_HEIGHT*(this._rollups[a].length-1);}return d;},_adjustFolding:function(a,b){var c=a,d=keys(this._rollups);while(a>0&&d.length){var e=d[b?'pop':'shift']();if(!b==!this._rolledup[e])continue;var f=this._getRollupSize(e);if(f<=0)continue;if(!b&&f>a)break;this[b?'_collapseRollup':'_expandRollup'](e);a-=f;}return c-a;},_collapseRollup:function(a){var b=this._rollups[a];if(!b||b.length<2||this._rolledup[a])return;var c=b[0].previousSibling,d=b[0],e=$N('a',{href:d.firstChild.href,rel:'ignore'},[a]),f=$N('ul',{className:'clearfix'});for(var g=0;g<b.length;g++)f.appendChild(b[g]);var h=$N('li',{},[e,f]);if(this.decadesAreSelectable){var i=b[b.length-1],j=d.getAttribute('data-key')+i.getAttribute('data-key');h.setAttribute('data-start',i.getAttribute('data-start'));h.setAttribute('data-end',d.getAttribute('data-end'));h.setAttribute('data-key',j);this._navKeys[j]=h;}else h.setAttribute('data-key',d.getAttribute('data-key'));h.setAttribute('data-rollup',a);if(c){DOM.insertAfter(c,h);}else DOM.prependContent(this._root,h);this._rolledup[a]=h;this._checkSelection();},_expandRollup:function(a){if(!this._rolledup[a])return;var b=this._rolledup[a],c=DOM.scry(b,'ul')[0],d=document.createDocumentFragment();while(c.childNodes.length)d.appendChild(c.firstChild);DOM.replace(b,d);this._rolledup[a]=false;this._checkSelection();},_checkSelection:function(){if(this._currentNav){var a=this._currentSubNav&&this._currentSubNav.getAttribute('data-key');this.updateSection(this._currentNav.getAttribute('data-key'),a);}},_handleScrub:function(event){var a=event.getModifiers();if(event.isMiddleClick()||a.access||a.meta)return true;var b=Parent.byTag(event.getTarget(),'a'),c=b&&Parent.byAttribute(b,'data-key');if(c){TimelineController.scrubberWasClicked(c.getAttribute('data-key'));TimelineController.navigateToSection(c.getAttribute('data-key'));return event.prevent();}}});
function TimelineMainScrubber(a){this.parent.construct(this,a);this._subscribe=Arbiter.subscribe(TimelineController.SECTION_LOADED,function(b,c){var d=this._navKeys[c.key],e=d&&DOM.scry(d,'ul')[0];if(e){CSS.addClass(e,'loaded');TimelineController.scrubberHasChangedState();if(c.hideSubSections)CSS.hide(e);}}.bind(this));}Class.extend(TimelineMainScrubber,'TimelineScrubber');copy_properties(TimelineMainScrubber.prototype,{reset:function(){this.parent.reset();this._subscribe&&this._subscribe.unsubscribe();}});
var SubscribeButton=window.SubscribeButton||(function(){return {init:function(a,b,c,d){Event.listen(b,'click',function(){Arbiter.inform('FollowingUser',{profile_id:d});});Arbiter.subscribe('FollowingUser',function(e,f){if(d===f.profile_id)a.swap();});Arbiter.subscribe('UnfollowingUser',function(e,f){if(d===f.profile_id){a.unswap();c.hideFlyout();Arbiter.inform('SubMenu/Reset');}});},initUnsubscribe:function(a,b){Event.listen(a,'click',function(){Arbiter.inform.bind(Arbiter,'UnfollowingUser',{profile_id:b}).defer();});}};})();